<!doctype html><html><!doctype html>
<html>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content>
<meta name=author content>
<title>Apache Hive : Manual Installation</title>
<link rel=icon href=/images/hive.svg sizes=any type=image/svg+xml>
<link rel=stylesheet href=https://hive.apache.org/css/hive-theme.css>
<link rel=stylesheet href=https://hive.apache.org/css/font-awesome.all.min.css>
<link rel=stylesheet href=https://hive.apache.org/css/bootstrap.min.css>
<link rel=stylesheet href=https://hive.apache.org/css/termynal.css>
<link rel=apple-touch-icon sizes=180x180 href=https://hive.apache.org/images/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=https://hive.apache.org/images/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=https://hive.apache.org/images/favicon-16x16.png>
<link rel=manifest href=https://hive.apache.org/images/site.webmanifest>
<link rel=mask-icon href=https://hive.apache.org/images/safari-pinned-tab.svg color=#5bbad5>
<meta name=msapplication-TileColor content="#da532c">
<meta name=theme-color content="#ffffff">
<script>var _paq=window._paq=window._paq||[];_paq.push(['disableCookies']),_paq.push(['trackPageView']),_paq.push(['enableLinkTracking']),function(){var b="https://analytics.apache.org/",c,a,d;_paq.push(['setTrackerUrl',b+'matomo.php']),_paq.push(['setSiteId','30']),c=document,a=c.createElement('script'),d=c.getElementsByTagName('script')[0],a.async=!0,a.src=b+'matomo.js',d.parentNode.insertBefore(a,d)}()</script>
</head>
<body>
<body>
<header>
<menu style=background:#000;margin:0>
<nav class="navbar navbar-expand-lg navbar-dark bg-black">
<div class=container-fluid>
<a href=https://hive.apache.org> <img src=https://hive.apache.org/images/hive.svg width=60 height=35 alt="Apache Software Foundation"></a>
<a class="header-text navbar-brand" href=https://hive.apache.org>Apache Hive</a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span>
</button>
<div class="collapse navbar-collapse" id=navbarSupportedContent>
<ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item dropdown">
<a class=nav-link href=/general/downloads id=navbarDropdown role=button aria-expanded=false>
Releases
</a>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=/Document id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
Documentation
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=/docs/latest/>Latest</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/docs/javadocs/>Javadocs</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/LanguageManual>Language Manual</a></li>
</ul>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=/general id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
General
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=https://www.apache.org/licenses/LICENSE-2.0.html>License</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/general/privacypolicy/>Privacy Policy</a></li>
</ul>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
Development
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=https://hive.apache.org/development/gettingstarted/>Getting Started</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/development/quickstart/>Quickstart with Docker</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/DesignDocs>Design Docs</a></li>
<li><a class=dropdown-item href=https://issues.apache.org/jira/projects/HIVE/issues>Hive JIRA</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/HiveDeveloperFAQ>Hive Developer FAQ</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/Hive+PreCommit+Patch+Testing>Precommit Patch Testing</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/development/versioncontrol/>Version Control</a></li>
</ul>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
Community
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=/community/becomingcommitter/>Becoming A Committer</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/HowToContribute>How To Contribute</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/Home#Home-ResourcesforContributors>Resources for Contributors</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/community/mailinglists/>Mailing Lists</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/community/issuetracking/>Issue Tracking</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/community/people/>People</a></li>
<li>
<hr class=dropdown-divider>
</li>
<li><a class=dropdown-item href=/community/bylaws/>By Laws</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/HowToRelease>How To Release</a></li>
</ul>
</li>
<li class="nav-item dropdown">
<a class=nav-link href=https://hive.blog.apache.org/ id=navbarDropdown role=button aria-expanded=false>
Blogs
</a>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
ASF
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=https://www.apache.org/foundation/contributing.html>Donations</a></li>
<li><a class=dropdown-item href=https://www.apache.org/foundation/sponsorship.html>Sponsorship</a></li>
<li><a class=dropdown-item href=https://www.apache.org/foundation/thanks.html>Thanks</a></li>
<li><a class=dropdown-item href=https://www.apache.org/>Website</a></li>
</ul>
</li>
<li>
<form action=/search method=get class=search-bar>
<input type=search name=q id=search-query placeholder=Search... class=search-input>
<button type=submit class=search-button>Search</button>
</form>
</li>
</ul>
</div>
</div>
</nav>
</menu>
</header>
<div class=content>
<div class=docs>
<h1 id=apache-hive--manual-installation>Apache Hive : Manual Installation</h1>
<ul>
<li><a href=#installing-configuring-and-running-hive>Installing, configuring and running Hive</a>
<ul>
<li><a href=#prerequisites>Prerequisites</a></li>
<li><a href=#install-the-prerequisites>Install the prerequisites</a>
<ul>
<li><a href=#java-8>Java 8</a></li>
<li><a href=#maven>Maven:</a></li>
<li><a href=#protobuf>Protobuf</a></li>
<li><a href=#hadoop>Hadoop</a></li>
<li><a href=#tez>Tez</a></li>
</ul>
</li>
<li><a href=#extra-hadoop-configurations-to-make-everything-working>Extra hadoop configurations to make everything working</a></li>
<li><a href=#installing-hive-from-a-tarball>Installing Hive from a Tarball</a></li>
<li><a href=#installing-from-source-code>Installing from Source Code</a></li>
<li><a href=#installing-with-old-version-hadoopgreater-than-or-equal-310>Installing with old version hadoop(greater than or equal 3.1.0)</a></li>
<li><a href=#next-steps>Next Steps</a></li>
<li><a href=#beeline-cli>Beeline CLI</a></li>
<li><a href=#hive-metastore>Hive Metastore</a></li>
<li><a href=#hcatalog-and-webhcat>HCatalog and WebHCat</a>
<ul>
<li><a href=#hcatalog>HCatalog</a></li>
<li><a href=#webhcat-templeton>WebHCat (Templeton)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id=installing-configuring-and-running-hive>Installing, configuring and running Hive</h1>
<p>You can install a stable release of Hive by downloading and unpacking a tarball, or you can download the source code and build Hive using Maven (release 3.6.3 and later).</p>
<h2 id=prerequisites>Prerequisites</h2>
<ul>
<li>Java 8.</li>
<li>Maven 3.6.3</li>
<li>Protobuf 2.5</li>
<li>Hadoop 3.3.6 (As a preparation, configure it in <a href=https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/SingleCluster.html#Pseudo-Distributed_Operation>single-node cluster, pseudo-distributed mode</a>)</li>
<li><a href=https://tez.apache.org/>Tez</a>. The default is MapReduce but we will change the execution engine to Tez.</li>
<li>Hive is commonly used in production Linux environment. Mac is a commonly used development environment. The instructions in this document are applicable to Linux and Mac.</li>
</ul>
<h2 id=install-the-prerequisites>Install the prerequisites</h2>
<h3 id=java-8>Java 8</h3>
<p>Building Hive requires JDK 8 installed. Some notes in case you have ARM chipset (Apple M1 or later).</p>
<p>You will have to build protobuf 2.5 later. And it doesn&rsquo;t compile with ARM JDK. So we will install intel architecture&rsquo;s Java with brew and configure maven with this. It will enable us to compile protobuf. </p>
<p>JDK install on apple ARM: </p>
<pre tabindex=0><code>brew install homebrew/cask-versions/adoptopenjdk8 --cask
brew untap adoptopenjdk/openjdk
</code></pre><h3 id=maven>Maven:</h3>
<p>Just install maven and configure the JAVA_HOME properly. </p>
<p>Notes for arm: after a proper configuration, you should see something like this:</p>
<pre tabindex=0><code>mvn -version
Apache Maven 3.6.3 (cecedd343002696d0abb50b32b541b8a6ba2883f)
Maven home: /Users/yourusername/programs/apache-maven-3.6.3
Java version: 1.8.0_292, vendor: AdoptOpenJDK, runtime: /Library/Java/JavaVirtualMachines/adoptopenjdk-8.jdk/Contents/Home/jre
Default locale: en_HU, platform encoding: UTF-8
OS name: &quot;mac os x&quot;, version: &quot;10.16&quot;, arch: &quot;x86_64&quot;, family: &quot;mac&quot;
</code></pre><p>As you can see, even if it is an arm processor, maven thinks the architecture is Intel based.</p>
<h3 id=protobuf>Protobuf</h3>
<p>You have to download and compile protobuf. And also, install it into the local maven repository. Protobuf 2.5.0 is not ready for ARM. On this chipset, you will need to do some extra steps.</p>
<pre tabindex=0><code>wget https://github.com/google/protobuf/releases/download/v2.5.0/protobuf-2.5.0.tar.bz2
tar -xvf protobuf-2.5.0.tar.bz2
cd protobuf-2.5.0
./configure
</code></pre><p>On ARM, edit the src/google/protobuf/stubs/platform_macros.h and add arm to the part, processor architecture detection, after the last elif branch: <br>
 </p>
<pre tabindex=0><code>#elif defined(__arm64__)
#define GOOGLE_PROTOBUF_ARCH_ARM 1
#define GOOGLE_PROTOBUF_ARCH_64_BIT 1
</code></pre><p>Now, you can compile and install protobuf:</p>
<pre tabindex=0><code>make
make check
sudo make install
</code></pre><p>You can validate your install:</p>
<pre tabindex=0><code>protoc --version
</code></pre><h3 id=hadoop>Hadoop</h3>
<p>Firstly, move through the instructions on the official documentation, single-node, pseudo-distributed configuration: <a href=https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/SingleCluster.html#Pseudo-Distributed_Operation>https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/SingleCluster.html#Pseudo-Distributed_Operation</a>.</p>
<p>After that, set up HADOOP_HOME:</p>
<pre tabindex=0><code>export HADOOP_HOME=/yourpathtohadoop/hadoop-3.3.6
</code></pre><h3 id=tez>Tez</h3>
<p>Tez will require some additional steps. Hadoop uses a tez tarball but it expects it in other compressed directory structure than it is released. So we will extract the tarball and compress again. And also, we will put the extracted jars into hdfs. After that we set the necessary environment variables.</p>
<p>Download tez, extract and re-compress the tar: </p>
<pre tabindex=0><code>wget https://dlcdn.apache.org/tez/0.10.3/apache-tez-0.10.3-bin.tar.gz
tar -xzvf apache-tez-0.10.3-bin.tar.gz
cd apache-tez-0.10.3-bin
tar zcvf ../apache-tez-0.10.3-bin.tar.gz * &amp;&amp; cd ..
</code></pre><p>Add the necessary tez files to hdfs</p>
<pre tabindex=0><code>$HADOOP_HOME/sbin/start-dfs.sh	# start hdfs
$HADOOP_HOME/bin/hadoop fs -mkdir -p /apps/tez
$HADOOP_HOME/bin/hadoop fs -put apache-tez-0.10.3-bin.tar.gz /apps/tez # copy the tarball
$HADOOP_HOME/bin/hadoop fs -put apache-tez-0.10.3-bin /apps/tez # copy the whole folder
$HADOOP_HOME/bin/hadoop fs -ls /apps/tez # verify
$HADOOP_HOME/sbin/stop-all.sh # stop hdfs
</code></pre><p>Set up TEZ_HOME and HADOOP_CLASSPATH environment variables</p>
<pre tabindex=0><code>export TEZ_HOME=/yourpathtotez/apache-tez-0.10.3-bin
export HADOOP_CLASSPATH=$TEZ_HOME/*:$TEZ_HOME/conf
</code></pre><p>Create a new config file for Tez: $TEZ_HOME/conf/tez-site.xml</p>
<pre tabindex=0><code>&lt;configuration&gt;
    &lt;property&gt;
        &lt;name&gt;tez.lib.uris&lt;/name&gt;
        &lt;value&gt;hdfs://localhost:9000/apps/tez/apache-tez-0.10.3-bin.tar.gz,hdfs://localhost:9000/apps/tez/apache-tez-0.10.3-bin/lib,hdfs://localhost:9000/apps/tez/apache-tez-0.10.3-bin&lt;/value&gt;
    &lt;/property&gt;
&lt;/configuration&gt;
</code></pre><h2 id=extra-hadoop-configurations-to-make-everything-working>Extra hadoop configurations to make everything working</h2>
<p>Modify $HADOOP_HOME/<strong>etc/hadoop/core-site.xml</strong></p>
<pre tabindex=0><code>&lt;configuration&gt;
    &lt;property&gt;
        &lt;name&gt;fs.defaultFS&lt;/name&gt;
        &lt;value&gt;hdfs://localhost:9000&lt;/value&gt;
    &lt;/property&gt;

    &lt;property&gt;
      &lt;name&gt;hadoop.proxyuser.yourusername.groups&lt;/name&gt;
      &lt;value&gt;*&lt;/value&gt;
    &lt;/property&gt;

    &lt;property&gt;
      &lt;name&gt;hadoop.proxyuser.yourusername.hosts&lt;/name&gt;
      &lt;value&gt;*&lt;/value&gt;
    &lt;/property&gt;
&lt;/configuration&gt;
</code></pre><p>Modify $HADOOP_HOME/<strong>etc/hadoop/hadoop-env.sh</strong></p>
<pre tabindex=0><code># JAVA_HOME
export JAVA_HOME=/yourpathtojavahome/javahome
# tez
export TEZ_CONF_DIR=/yourpathtotezconf/conf
export TEZ_JARS=/yourpathtotez/apache-tez-0.10.3-bin
export HADOOP_CLASSPATH=${TEZ_CONF_DIR}:${TEZ_JARS}/*:${TEZ_JARS}/lib/*:${HADOOP_CLASSPATH}:
${JAVA_JDBC_LIBS}:${MAPREDUCE_LIBS}
</code></pre><p>Modify $HADOOP_HOME/<strong>etc/hadoop/mapred-site.xml</strong></p>
<pre tabindex=0><code>&lt;configuration&gt;
    &lt;property&gt;
        &lt;name&gt;mapreduce.framework.name&lt;/name&gt;
        &lt;value&gt;yarn&lt;/value&gt;
    &lt;/property&gt;
    &lt;property&gt;
        &lt;name&gt;mapreduce.application.classpath&lt;/name&gt;
        &lt;value&gt;$HADOOP_CLASSPATH:$HADOOP_HOME/share/hadoop/mapreduce/*:$HADOOP_MAPRED_HOME/share/hadoop/mapreduce/lib/*&lt;/value&gt;
    &lt;/property&gt;
&lt;/configuration&gt;
</code></pre><p>Modify $HADOOP_HOME/<strong>etc/hadoop/yarn-site.xml</strong></p>
<pre tabindex=0><code>&lt;configuration&gt;
&lt;!-- Site specific YARN configuration properties --&gt;
  &lt;property&gt;
    &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;
    &lt;value&gt;mapreduce_shuffle&lt;/value&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;yarn.nodemanager.env-whitelist&lt;/name&gt;
    &lt;value&gt;JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_HOME,PATH,LANG,TZ,HADOOP_MAPRED_HOME&lt;/value&gt;
  &lt;/property&gt;
    &lt;property&gt;
    &lt;name&gt;yarn.nodemanager.resource.memory-mb&lt;/name&gt;
  &lt;value&gt;4096&lt;/value&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;yarn.scheduler.minimum-allocation-mb&lt;/name&gt;
    &lt;value&gt;2048&lt;/value&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;yarn.nodemanager.vmem-pmem-ratio&lt;/name&gt;
    &lt;value&gt;2.1&lt;/value&gt;
  &lt;/property&gt;
&lt;/configuration&gt;
</code></pre><p>Start hadoop</p>
<p>If you already started hadoop before, stop it. As we configured yarn and map-reduce, we have to restart it and make sure yarn is running:</p>
<pre tabindex=0><code>$HADOOP_HOME/sbin/stop-all.sh
</code></pre><p>And start hadoop:</p>
<pre tabindex=0><code>$HADOOP_HOME/sbin/start-all.sh
</code></pre><h2 id=installing-hive-from-a-tarball>Installing Hive from a Tarball</h2>
<p>Start by downloading the most recent stable release of Hive from one of the Apache download mirrors (see <a href=https://hive.apache.org/downloads.html>Hive Releases</a>).</p>
<p>Next you need to unpack the tarball. This will result in the creation of a subdirectory named <code>hive-x.y.z</code> (where <code>x.y.z</code> is the release number):</p>
<pre tabindex=0><code>wget https://dlcdn.apache.org/hive/hive-4.0.0/apache-hive-4.0.0-bin.tar.gz
tar -xzvf apache-hive-4.0.0-bin.tar.gz 
</code></pre><p>Set the environment variable <code>HIVE_HOME</code> to point to the installation directory:</p>
<pre tabindex=0><code>cd apache-hive-4.0.0-bin
export HIVE_HOME=/yourpathtohive/apache-hive-4.0.0-bin 
</code></pre><p>Add <code>$HIVE_HOME/bin</code> to your <code>PATH</code>:</p>
<pre tabindex=0><code>export PATH=$HIVE_HOME/bin:$PATH
</code></pre><p>Create a directory for external tables: </p>
<pre tabindex=0><code>mkdir /yourpathtoexternaltables/warehouse
</code></pre><p>Create a new config file for Hive: $HIVE_HOME/conf/hive-site.xml</p>
<pre tabindex=0><code>&lt;configuration&gt;
    &lt;property&gt;
        &lt;name&gt;hive.tez.container.size&lt;/name&gt;
        &lt;value&gt;1024&lt;/value&gt;
    &lt;/property&gt;

    &lt;property&gt;
        &lt;name&gt;hive.metastore.warehouse.external.dir&lt;/name&gt;
        &lt;value&gt;/yourpathtowarehousedirectory/warehouse&lt;/value&gt;
    &lt;/property&gt;

    &lt;property&gt;
        &lt;name&gt;hive.execution.engine&lt;/name&gt;
        &lt;value&gt;tez&lt;/value&gt;
    &lt;/property&gt;

    &lt;property&gt;
        &lt;name&gt;tez.lib.uris&lt;/name&gt;
        &lt;value&gt;hdfs://localhost:9000/apps/tez/apache-tez-0.10.3-bin.tar.gz,hdfs://localhost:9000/apps/tez/apache-tez-0.10.3-bin/lib,hdfs://localhost:9000/apps/tez/apache-tez-0.10.3-bin&lt;/value&gt;
    &lt;/property&gt;

    &lt;property&gt;
        &lt;name&gt;tez.configuration&lt;/name&gt;
        &lt;value&gt;/yourpathtotez/apache-tez-0.10.3-bin/conf/tez-site.xml&lt;/value&gt;
    &lt;/property&gt;

    &lt;property&gt;
        &lt;name&gt;tez.use.cluster.hadoop-libs&lt;/name&gt;
        &lt;value&gt;true&lt;/value&gt;
    &lt;/property&gt;
&lt;/configuration&gt;
</code></pre><p>Initialize metastore schema. It will create a directore called metastore_db. It contains an embedded Derby database for metastore</p>
<pre tabindex=0><code>$HIVE_HOME/bin/schematool -dbType derby -initSchema --verbose
</code></pre><p>Run HiveServer2</p>
<pre tabindex=0><code>$HIVE_HOME/bin/hiveserver2
</code></pre><p><strong>Note</strong>: you can check if it is running in Hive Server web ui: <a href=http://localhost:10002/>http://localhost:10002/</a></p>
<p>Run beeline:</p>
<pre tabindex=0><code>$HIVE_HOME/bin/beeline -u 'jdbc:hive2://localhost:10000/' -n yourusername
</code></pre><p>As a test, create a table insert some value</p>
<pre tabindex=0><code>create table test (message string);
insert into test values ('Hello, from Hive!');
</code></pre><h2 id=installing-from-source-code>Installing from Source Code</h2>
<p>Configuring is the same as when we do it from tarball. The only difference is that we have to build Hive for ourself and we will find the compiled binaries in a different directory.</p>
<p>Hive is available via Git at <a href=https://github.com/apache/hive>https://github.com/apache/hive</a>. You can download it by running the following command.</p>
<pre tabindex=0><code>git clone git@github.com:apache/hive.git
</code></pre><p>In case you want to get a specific release branch, like 4.0.0, you can run that command: </p>
<pre tabindex=0><code>git clone -b branch-4.0 --single-branch git@github.com:apache/hive.git
</code></pre><p>To build Hive, execute the following command on the base directory:</p>
<pre tabindex=0><code>  $ mvn clean install -Pdist,iceberg -DskipTests 
</code></pre><p>It will create the subdirectory <strong>packaging/target/apache-hive-<em>&lt;release_string></em>-bin/apache-hive-<em>&lt;release_string></em>-bin/. That will be your HIVE_HOME directory.</strong></p>
<p>It has a content like:</p>
<ul>
<li>bin/: directory containing all the shell scripts</li>
<li>lib/: directory containing all required jar files</li>
<li>conf/: directory with configuration files</li>
<li>examples/: directory with sample input and query files</li>
</ul>
<p>That directory should contain all the files necessary to run Hive. You can run it from there or copy it to a different location, if you prefer.</p>
<p>From now, you can follow the steps described in the section Installing Hive from a Tarball</p>
<h2 id=installing-with-old-version-hadoopgreater-than-or-equal-310>Installing with old version hadoop(greater than or equal 3.1.0)</h2>
<p>Although we normally require hive4 to rely on a
hadoop 3.3.6+ cluster environment.
However, in practice, in an ON YARN environment,
we can package all the hadoop related dependencies into
tez&hive so that they do not need to rely on the lib
of the original hadoop cluster environment at runtime.
In this way, we can run HIVE4 in a lower version of hadoop,
provided that the base APIs of the hadoop 3.x series are common to
each other.</p>
<p>The steps are as follows:</p>
<p>1.Compile TEZ to get tez.tar.gz which contains all hadoop related dependencies(not tez minimal tarball),
run <code>mvn clean install -DskipTests=true -Dmaven.javadoc.skip=true -Pdist -Paws -Pazure</code>.
For more detail,see:<code>https://tez.apache.org/install.html</code>.
After compiling to get tez.tar.gz, users should set the following properties in tez-site.xml:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml>    <span style=color:#f92672>&lt;property&gt;</span>
        <span style=color:#f92672>&lt;name&gt;</span>tez.lib.uris<span style=color:#f92672>&lt;/name&gt;</span><span style=color:#75715e>&lt;!--Example, replace with actual hdfs path--&gt;</span>
        <span style=color:#f92672>&lt;value&gt;</span>/apps/apache-tez-0.10.4-bin.tar.gz<span style=color:#f92672>&lt;/value&gt;</span>
    <span style=color:#f92672>&lt;/property&gt;</span>
    <span style=color:#f92672>&lt;property&gt;</span>
        <span style=color:#f92672>&lt;name&gt;</span>tez.lib.uris.classpath<span style=color:#f92672>&lt;/name&gt;</span> <span style=color:#75715e>&lt;!--only use tez self lib,do not use any old version hadoop cluster&#39;s lib--&gt;</span>
       <span style=color:#f92672>&lt;value&gt;</span>$PWD/tezlib/*,$PWD/tezlib/lib/*<span style=color:#f92672>&lt;/value&gt;</span>
    <span style=color:#f92672>&lt;/property&gt;</span>
    <span style=color:#f92672>&lt;property&gt;</span>
        <span style=color:#f92672>&lt;name&gt;</span>tez.use.cluster.hadoop-libs<span style=color:#f92672>&lt;/name&gt;</span><span style=color:#75715e>&lt;!--only use tez self lib,do not use any old version hadoop cluster&#39;s lib--&gt;</span>
        <span style=color:#f92672>&lt;value&gt;</span>false<span style=color:#f92672>&lt;/value&gt;</span>
    <span style=color:#f92672>&lt;/property&gt;</span>

    <span style=color:#f92672>&lt;property&gt;</span>
        <span style=color:#f92672>&lt;name&gt;</span>tez.am.launch.env<span style=color:#f92672>&lt;/name&gt;</span><span style=color:#75715e>&lt;!--Example, replace with actual native-lib install path.Reuse old version hadoop cluster&#39;s native lib is ok.--&gt;</span>
        <span style=color:#f92672>&lt;value&gt;</span>LD_LIBRARY_PATH=/usr/hadoop/3.1.0/hadoop/lib/native<span style=color:#f92672>&lt;/value&gt;</span>
        <span style=color:#f92672>&lt;description&gt;</span>Users can set up environment variables individually, including but not limited to: JAVA_HOME, LD_LIBRARY_PATH.<span style=color:#f92672>&lt;/description&gt;</span>
    <span style=color:#f92672>&lt;/property&gt;</span>
    
    <span style=color:#f92672>&lt;property&gt;</span>
        <span style=color:#f92672>&lt;name&gt;</span>tez.task.launch.env<span style=color:#f92672>&lt;/name&gt;</span><span style=color:#75715e>&lt;!--Example, replace with actual native-lib install path.Reuse old version hadoop cluster&#39;s native lib is ok.--&gt;</span>
        <span style=color:#f92672>&lt;value&gt;</span>LD_LIBRARY_PATH=/usr/hadoop/3.1.0/hadoop/lib/native<span style=color:#f92672>&lt;/value&gt;</span>
        <span style=color:#f92672>&lt;description&gt;</span>Users can set up environment variables individually, including but not limited to: JAVA_HOME, LD_LIBRARY_PATH.<span style=color:#f92672>&lt;/description&gt;</span>
    <span style=color:#f92672>&lt;/property&gt;</span>
</code></pre></div><p>2.Upload tez to the specified HDFS path in <code>tez.lib.uris</code>.(Please remember, do not use the minimal tarball for installation.)</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e>## DO not upload minimal tarball !!!</span>
<span style=color:#f92672>[</span>hadoop@hive opt<span style=color:#f92672>]</span><span style=color:#75715e># hdfs dfs -put apache-tez-0.10.4-bin.tar.gz /apps/</span>
</code></pre></div><p>3.Download the high version of the Hadoop package(Please ensure that the HADOOP version on which TEZ depends is the same as the HADOOP version you have downloaded.).Unzip HIVE, HADOOP, and TEZ all in the installation path.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e>## In this example, we have installed HIVE-4.0.1 and TEZ-0.10.4 on an Hadoop 3.1.0 cluster.users should install HIVE,HADOOP and TEZ into actual directories.</span>
<span style=color:#f92672>[</span>hadoop@hive opt<span style=color:#f92672>]</span><span style=color:#75715e># cd /opt</span>
<span style=color:#f92672>[</span>hadoop@hive opt<span style=color:#f92672>]</span><span style=color:#75715e># ll</span>
drwxr-xr-x <span style=color:#ae81ff>11</span> hive hadoop      <span style=color:#ae81ff>4096</span> Nov  <span style=color:#ae81ff>7</span> 13:59 apache-hive-4.0.1-bin
drwxr-xr-x  <span style=color:#ae81ff>3</span> hive hadoop      <span style=color:#ae81ff>4096</span> Nov  <span style=color:#ae81ff>7</span> 13:59 apache-tez-0.10.4-bin
drwxr-xr-x <span style=color:#ae81ff>10</span> hive hadoop      <span style=color:#ae81ff>4096</span> Nov  <span style=color:#ae81ff>7</span> 13:59 hadoop-3.3.6
lrwxrwxrwx  <span style=color:#ae81ff>1</span> hive hadoop        <span style=color:#ae81ff>30</span> Nov  <span style=color:#ae81ff>7</span> 13:59 hive-4.0.1 -&gt; apache-hive-4.0.1-bin
lrwxrwxrwx  <span style=color:#ae81ff>1</span> hive hadoop        <span style=color:#ae81ff>21</span> Nov  <span style=color:#ae81ff>7</span> 13:59 tez -&gt; apache-tez-0.10.4-bin
</code></pre></div><p>edit <code>hive-env.sh</code></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e># Set HADOOP_HOME to point to a specific hadoop install directory</span>
HADOOP_HOME<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>HADOOP_HOME<span style=color:#66d9ef>:-</span>/opt/hadoop-3.3.6<span style=color:#e6db74>}</span>
export HIVE_HOME<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>HIVE_HOME<span style=color:#66d9ef>:-</span>/opt/hive-4.0.1<span style=color:#e6db74>}</span>
export TEZ_HOME<span style=color:#f92672>=</span>/opt/tez
</code></pre></div><p>Copy old version hadoop conf into hadoop3.3.6+:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cp /usr/hadoop/3.1.0/hadoop/conf/*  /opt/hadoop3.3.6/conf/
</code></pre></div><p>Put <code>tez-site.xml</code> into hive conf dir:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>mv tez-site.xml  /opt/hive-4.0.1/conf/
</code></pre></div><p>After completing the above steps, users should be able to start the HMS service and HS2 service normally, and submit TEZ computing tasks without any issues.</p>
<p>Through the above steps, we can run Hive4+tez in any Hadoop3 environment. Users do not need to upgrade the cluster&rsquo;s original hive/hadoop/tez.</p>
<h2 id=next-steps>Next Steps</h2>
<p>You can begin using Hive as soon as it is installed, it should be work on you computer. There are some extra information in the following sections.</p>
<h2 id=beeline-cli>Beeline CLI</h2>
<p>HiveServer2 has a CLI called Beeline (see <a href=https://cwiki.apache.org/confluence/display/Hive/HiveServer2+Clients#HiveServer2Clients-Beeline--NewCommandLineShell>Beeline – New Command Line Shell</a>). To use Beeline, execute the following command in the Hive home directory:</p>
<pre tabindex=0><code>$ bin/beeline
</code></pre><h2 id=hive-metastore>Hive Metastore</h2>
<p>Metadata is stored in a relational database. In our example (and as a default) it is a Derby database. By default, it&rsquo;s location is ./metastore_db. (See conf/hive-default.xml). You can change it by modifying the configuration variable javax.jdo.option.ConnectionURL.</p>
<p>Using Derby in embedded mode allows at most one user at a time. To configure Derby to run in server mode, see <a href=https://hive.apache.org/docs/latest/hivederbyservermode_27362068/>Hive Using Derby in Server Mode</a>.</p>
<p>To configure a database other than Derby for the Hive metastore, see <a href=https://hive.apache.org/docs/latest/adminmanual-metastore-administration_27362076/>Hive Metastore Administration</a>.</p>
<p><strong>Next Step:</strong> <a href=https://hive.apache.org/docs/latest/adminmanual-configuration_27362070/>Configuring Hive</a>.</p>
<h2 id=hcatalog-and-webhcat>HCatalog and WebHCat</h2>
<h3 id=hcatalog>HCatalog</h3>
<p>If you install Hive from the binary tarball, the <code>hcat</code> command is available in the <code>hcatalog/bin</code> directory. However, most <code>hcat</code> commands can be issued as <code>hive</code> commands except for &ldquo;<code>hcat -g</code>&rdquo; and &ldquo;<code>hcat -p</code>&rdquo;. Note that the <code>hcat</code> command uses the <code>-p</code> flag for permissions but <code>hive</code> uses it to specify a port number. The HCatalog CLI is documented <a href=https://hive.apache.org/docs/latest/hcatalog-cli_34013932/>here</a> and the Hive CLI is documented <a href=https://hive.apache.org/docs/latest/languagemanual-cli_27362033/>here</a>.</p>
<p>HCatalog installation is documented <a href=https://hive.apache.org/docs/latest/hcatalog-installhcat_34013403/>here</a>.</p>
<h3 id=webhcat-templeton>WebHCat (Templeton)</h3>
<p>If you install Hive from the binary tarball, the WebHCat server command <code>webhcat_server.sh</code> is in the hcatalog/webhcat/svr/src/main/bin/webhcat_server.sh directory.</p>
<p>WebHCat installation is documented <a href=https://hive.apache.org/docs/latest/webhcat-installwebhcat_34015585/>here</a>.</p>
</div>
</div>
<footer class="black-background static-bottom" style=padding:30px>
<div class=row>
<div class=col-3>
<a href=https://www.apache.org/>
<img src=https://hive.apache.org/images/asf_logo.png width=270 height=100 alt="Apache Software Foundation"></a>
</a>
</div>
<div class=col-9>
<p class=footer-text>Apache is a non-profit organization helping open-source
software projects released under the Apache
<a href=https://www.apache.org/licenses/>license</a>
and managed with
<a href=https://www.apache.org/foundation/how-it-works.html>
open governance</a> and
<a href=https://privacy.apache.org/policies/privacy-policy-public.html>
privacy policy</a>. See upcoming
<a href=https://www.apache.org/events/current-event>Apache Events</a>.
If you discover any
<a href=https://www.apache.org/security/>security</a> vulnerabilities, please
report them privately. Finally,
<a href=https://www.apache.org/foundation/sponsorship.html>thanks
</a> to the sponsors who
<a href=https://www.apache.org/foundation/contributing.html>
donate</a> to the Apache Foundation.
</p>
</div>
</div>
<div class="copyright row">
<a href=https://hive.apache.org style=color:grey>
The contents of this website are © 2023 Apache Software Foundation under the terms of the Apache License v2. Apache Hive and its logo are trademarks of the Apache Software Foundation.
</a>
</div>
</footer>
<script src=https://hive.apache.org/js/bootstrap.bundle.min.js></script>
</body>
</html>