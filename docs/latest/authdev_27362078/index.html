<!doctype html><html><!doctype html>
<html>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content>
<meta name=author content>
<title>Apache Hive : AuthDev</title>
<link rel=icon href=/images/hive.svg sizes=any type=image/svg+xml>
<link rel=stylesheet href=https://hive.apache.org/css/hive-theme.css>
<link rel=stylesheet href=https://hive.apache.org/css/font-awesome.all.min.css>
<link rel=stylesheet href=https://hive.apache.org/css/bootstrap.min.css>
<link rel=stylesheet href=https://hive.apache.org/css/termynal.css>
<link rel=apple-touch-icon sizes=180x180 href=https://hive.apache.org/images/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=https://hive.apache.org/images/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=https://hive.apache.org/images/favicon-16x16.png>
<link rel=manifest href=https://hive.apache.org/images/site.webmanifest>
<link rel=mask-icon href=https://hive.apache.org/images/safari-pinned-tab.svg color=#5bbad5>
<meta name=msapplication-TileColor content="#da532c">
<meta name=theme-color content="#ffffff">
<script>var _paq=window._paq=window._paq||[];_paq.push(['disableCookies']),_paq.push(['trackPageView']),_paq.push(['enableLinkTracking']),function(){var b="https://analytics.apache.org/",c,a,d;_paq.push(['setTrackerUrl',b+'matomo.php']),_paq.push(['setSiteId','30']),c=document,a=c.createElement('script'),d=c.getElementsByTagName('script')[0],a.async=!0,a.src=b+'matomo.js',d.parentNode.insertBefore(a,d)}()</script>
</head>
<body>
<body>
<header>
<menu style=background:#000;margin:0>
<nav class="navbar navbar-expand-lg navbar-dark bg-black">
<div class=container-fluid>
<a href=https://hive.apache.org> <img src=https://hive.apache.org/images/hive.svg width=60 height=35 alt="Apache Software Foundation"></a>
<a class="header-text navbar-brand" href=https://hive.apache.org>Apache Hive</a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span>
</button>
<div class="collapse navbar-collapse" id=navbarSupportedContent>
<ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item dropdown">
<a class=nav-link href=/general/downloads id=navbarDropdown role=button aria-expanded=false>
Releases
</a>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=/Document id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
Documentation
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=/docs/latest/>Latest</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/docs/javadocs/>Javadocs</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/LanguageManual>Language Manual</a></li>
</ul>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=/general id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
General
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=https://www.apache.org/licenses/LICENSE-2.0.html>License</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/general/privacypolicy/>Privacy Policy</a></li>
</ul>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
Development
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=https://hive.apache.org/development/gettingstarted/>Getting Started</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/development/quickstart/>Quickstart with Docker</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/DesignDocs>Design Docs</a></li>
<li><a class=dropdown-item href=https://issues.apache.org/jira/projects/HIVE/issues>Hive JIRA</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/HiveDeveloperFAQ>Hive Developer FAQ</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/Hive+PreCommit+Patch+Testing>Precommit Patch Testing</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/development/versioncontrol/>Version Control</a></li>
</ul>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
Community
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=/community/becomingcommitter/>Becoming A Committer</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/HowToContribute>How To Contribute</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/Home#Home-ResourcesforContributors>Resources for Contributors</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/community/mailinglists/>Mailing Lists</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/community/issuetracking/>Issue Tracking</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/community/people/>People</a></li>
<li>
<hr class=dropdown-divider>
</li>
<li><a class=dropdown-item href=/community/bylaws/>By Laws</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/HowToRelease>How To Release</a></li>
</ul>
</li>
<li class="nav-item dropdown">
<a class=nav-link href=https://hive.blog.apache.org/ id=navbarDropdown role=button aria-expanded=false>
Blogs
</a>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
ASF
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=https://www.apache.org/foundation/contributing.html>Donations</a></li>
<li><a class=dropdown-item href=https://www.apache.org/foundation/sponsorship.html>Sponsorship</a></li>
<li><a class=dropdown-item href=https://www.apache.org/foundation/thanks.html>Thanks</a></li>
<li><a class=dropdown-item href=https://www.apache.org/>Website</a></li>
</ul>
</li>
<li>
<form action=/search method=get class=search-bar>
<input type=search name=q id=search-query placeholder=Search... class=search-input>
<button type=submit class=search-button>Search</button>
</form>
</li>
</ul>
</div>
</div>
</nav>
</menu>
</header>
<div class=content>
<div class=docs>
<h1 id=apache-hive--authdev>Apache Hive : AuthDev</h1>
<p><strong>Index</strong></p>
<ul>
<li><a href=#1-privilege>1. Privilege</a>
<ul>
<li><a href=#11-access-privilege>1.1 Access Privilege</a></li>
</ul>
</li>
<li><a href=#2-hive-operations>2. Hive Operations</a></li>
<li><a href=#3-metadata>3. Metadata</a>
<ul>
<li><a href=#31-user-group-and-roles>3.1 user, group, and roles</a>
<ul>
<li><a href=#311-role-management>3.1.1 Role management</a></li>
<li><a href=#312-role-metadata>3.1.2 role metadata</a></li>
<li><a href=#313-hive-role-user-membership-table>3.1.3 hive role user membership table</a></li>
</ul>
</li>
<li><a href=#32-privileges-to-be-supported-by-hive>3.2 Privileges to be supported by Hive</a>
<ul>
<li><a href=#321-metadata>3.2.1 metadata</a></li>
</ul>
</li>
</ul>
</li>
<li><a href=#4-grantrevoke-access-privilege>4. grant/revoke access privilege</a>
<ul>
<li><a href=#41-privilege-namestypes>4.1 Privilege names/types:</a></li>
<li><a href=#42-show-grant>4.2 show grant</a></li>
<li><a href=#43-grantrevoke-statement>4.3 grant/revoke statement</a></li>
</ul>
</li>
<li><a href=#5-authorization-verification>5. Authorization verification</a>
<ul>
<li><a href=#51-usergrouprole>5.1 USER/GROUP/ROLE</a></li>
<li><a href=#52-the-verification-steps>5.2 The verification steps</a></li>
<li><a href=#53-examples>5.3 Examples</a></li>
</ul>
</li>
<li><a href=#6-where-to-add-authorization-in-hive>6. Where to add authorization in Hive</a></li>
<li><a href=#7-implementation>7. Implementation</a>
<ul>
<li><a href=#71-authenticator-interface>7.1 Authenticator interface</a></li>
<li><a href=#72-authorization>7.2 Authorization</a></li>
</ul>
</li>
<li><a href=#8-metastore-upgrade-script-for-mysql>8. Metastore upgrade script for mysql</a></li>
<li><a href=#hdfs-permission>HDFS Permission</a></li>
</ul>
<p>Authorization modes</p>
<p>This is the design document for the <a href=https://hive.apache.org/docs/latest/45876173/>original Hive authorization mode</a>. See <a href=https://hive.apache.org/docs/latest/languagemanual-authorization_27362032/>Authorization</a> for an overview of authorization modes, which include <a href=https://hive.apache.org/docs/latest/storage-based-authorization-in-the-metastore-server_45876440/>storage based authorization</a> and <a href=https://hive.apache.org/docs/latest/sql-standard-based-hive-authorization_40509928/>SQL standards based authorization</a>.</p>
<h1 id=1-privilege>1. Privilege</h1>
<h2 id=11-access-privilege>1.1 Access Privilege</h2>
<p>Admin privilege, DB privilege, Table level privilege, column level privilege</p>
<p>1.1.1 Admin privileges are global privileges, and are used to perform administration.</p>
<p>1.1.2 DB privileges are database specific, and apply to all objects inside that database.</p>
<p>1.1.3 Table privileges apply to table/view/index in a given database</p>
<p>1.1.4 Column privileges apply to column level.</p>
<p>All DB/Table/Column privilege differentiate read and write privileges even though now hive does not support column level overwrite. And there is no partition level privilege.</p>
<h1 id=2-hive-operations>2. Hive Operations</h1>
<p>create index/drop index</p>
<p>create database/drop database</p>
<p>create table/drop table</p>
<p>create view/drop view</p>
<p>alter table</p>
<p>show databases</p>
<p>lock table/unlock table/show lock</p>
<p>add partition</p>
<p>archive</p>
<p>Select</p>
<p>insert overwrite directory</p>
<p>insert overwrite table</p>
<p>others include &ldquo;create table as &ldquo;, &ldquo;create table like&rdquo; etc</p>
<h1 id=3-metadata>3. Metadata</h1>
<p>Store the privilege information in the new metastore tables &lsquo;user&rsquo;, &lsquo;db&rsquo;, &lsquo;tables_priv&rsquo;, &lsquo;columns_priv&rsquo;.</p>
<p>The user table indicates user&rsquo;s global privileges, which apply to all databases.<br>
The db table determine database level access privileges, which apply to all objects inside that database.</p>
<h2 id=31-user-group-and-roles>3.1 user, group, and roles</h2>
<p>User can belong to some groups. The group information is provided by authenticator.</p>
<p>And each user or group can have some privileges and roles. A role can be a member of another role, but not in a circular manner.</p>
<p>So hive metadata needs to store:</p>
<ol>
<li>
<p>roles -> privileges, roles mapping</p>
</li>
<li>
<p>Hive user/group -> privileges, role mapping</p>
</li>
</ol>
<h3 id=311-role-management>3.1.1 Role management</h3>
<p>create role</p>
<p>drop role</p>
<p>grant a role to a user</p>
<p>revoke a role from a user</p>
<h3 id=312-role-metadata>3.1.2 role metadata</h3>
<p>role_name - string</p>
<p>create_time - int</p>
<h3 id=313-hive-role-user-membership-table>3.1.3 hive role user membership table</h3>
<p>role_name - string</p>
<p>user_name - string</p>
<p>is_group – is the user name a group name</p>
<p>is_role – is the user name a role name</p>
<h2 id=32-privileges-to-be-supported-by-hive>3.2 Privileges to be supported by Hive</h2>
<h3 id=321-metadata>3.2.1 metadata</h3>
<p>The below shows how we store the grant information in metastore. The deny information is stored in a same matter (just in different tables).</p>
<p>So for each grant table, there will also be a deny table. The metastore tables are</p>
<p>user, deny_user, db, deny_db, tables_priv, deny_tables_priv, columns_priv, deny_columns_priv</p>
<p>Another way to do it is to add a column in the grant table to record this row is grant or deny.</p>
<p>We store privileges in one column, and use comma to separate different privileges.</p>
<p>hive> desc user;</p>
<p>Field</p>
<ul>
<li>
<hr>
</li>
</ul>
<p>User</p>
<p>isRole</p>
<p>isGroup</p>
<p>isSuper</p>
<p>db_priv – set (Select_priv, Insert_priv, Create_priv, Drop_priv, Reload_priv,</p>
<p>Grant_priv, Index_priv, Alter_priv, Show_db_priv,</p>
<p>Lock_tables_priv, Create_view_priv, Show_view_priv)</p>
<p>hive> desc db;</p>
<p>Field</p>
<ul>
<li>
<hr>
</li>
</ul>
<p>Db</p>
<p>User</p>
<p>isRole</p>
<p>isGroup</p>
<p>Table_priv – set (Select_priv, Insert_priv, Create_priv, Drop_priv, Grant_priv,</p>
<p>Index_priv, Reload_priv, Alter_priv, Create_tmp_table_priv,</p>
<p>Lock_tables_priv, Create_view_priv, Show_view_priv)</p>
<p>hive> desc tables_priv;</p>
<p>Field</p>
<ul>
<li>
<hr>
</li>
</ul>
<p>Db</p>
<p>User</p>
<p>isRole</p>
<p>isGroup</p>
<p>Table_name</p>
<p>Grantor</p>
<p>Timestamp</p>
<p>Table_priv – set(&lsquo;Select&rsquo;,&lsquo;Insert&rsquo;,,&lsquo;Create&rsquo;,&lsquo;Drop&rsquo;,&lsquo;Grant&rsquo;,&lsquo;Index&rsquo;,&lsquo;Alter&rsquo;,&lsquo;Create View&rsquo;,&lsquo;Show view&rsquo;)</p>
<p>Column_priv – set(&lsquo;Select&rsquo;,&lsquo;Insert&rsquo;,)</p>
<p>mysql> desc columns_priv;</p>
<p>Field</p>
<ul>
<li>
<hr>
</li>
</ul>
<p>Db</p>
<p>User</p>
<p>isRole</p>
<p>isGroup</p>
<p>Table_name</p>
<p>Column_name</p>
<p>Timestamp</p>
<p>Column_priv – set(&lsquo;Select&rsquo;,&lsquo;Insert&rsquo;,&lsquo;Update&rsquo;)</p>
<h1 id=4-grantrevoke-access-privilege>4. grant/revoke access privilege</h1>
<h2 id=41-privilege-namestypes>4.1 Privilege names/types:</h2>
<p>ALL Privileges</p>
<p>ALTER</p>
<p>Create</p>
<p>Create view</p>
<p>Delete</p>
<p>Drop</p>
<p>Index</p>
<p>Insert</p>
<p>Lock Tables</p>
<p>Select</p>
<p>Show databases</p>
<p>Super</p>
<h2 id=42-show-grant>4.2 show grant</h2>
<h2 id=43-grantrevoke-statement>4.3 grant/revoke statement</h2>
<pre tabindex=0><code>GRANT
    priv_type [(column_list)]
      [, priv_type [(column_list)]] ...
    ON [object_type] priv_level
    TO user [, user] ...
WITH ADMIN OPTION

object_type:
    TABLE

priv_level:
    *
  | *.*
  | db_name.*
  | db_name.tbl_name
  | tbl_name

REVOKE
    priv_type [(column_list)]
      [, priv_type [(column_list)]] ...
    ON [object_type] priv_level
    FROM user [, user] ...

REVOKE ALL PRIVILEGES, GRANT OPTION
    FROM user [, user] ...

DENY  
	priv_type [(column_list)]
      [, priv_type [(column_list)]] ...
    ON [object_type] priv_level
    FROM user [, user] ...

</code></pre><h1 id=5-authorization-verification>5. Authorization verification</h1>
<h2 id=51-usergrouprole>5.1 USER/GROUP/ROLE</h2>
<p>USER</p>
<p>GROUP</p>
<p>ROLE</p>
<p>GROUP is very similar to a role. And we support Group is because we may need to pass the group information to HDFS/Map-reduce.</p>
<p>A role can also contain other roles and privileges - and they can be granted to users and groups.</p>
<p>Role can be nested but not circular.</p>
<h2 id=52-the-verification-steps>5.2 The verification steps</h2>
<p>When a user logins to the system, he has a user name, one or few groups that he belongs to.<br>
So it is</p>
<p>[</p>
<pre tabindex=0><code>username, 

list of group names, 

list of privileges and roles that has been directly granted, 

list of privileges and roles that been directly granted to groups that users belongs to

</code></pre><p>].</p>
<ul>
<li>Steps to authorize one access: *</li>
</ul>
<pre tabindex=0><code>First try user name:

 # If there is an entry in 'user' that accept this access, return ACCEPT

2. If there is an entry in 'db'  that accept this access, return ACCEPT

3. If there is an entry in 'table'  that accept this access, return ACCEPT

4. If there is an entry in 'column'  that accept this access, return ACCEPT

Second try the user's group/role names one by one until we get an ACCEPT. 

For each role/group, we do the same routine as we did for user name.

</code></pre><h2 id=53-examples>5.3 Examples</h2>
<p>5.3.1 I want to grant everyone (new people may join at anytime) to<br>
db_name.*, and then later i want to protect one table db_name.T from ALL<br>
users but a few</p>
<ol>
<li>
<p>Add all users to a group &lsquo;users&rsquo;. (assumption: new users will<br>
automatically join this group). And grant &lsquo;users&rsquo; ALL privileges to db_name.*</p>
</li>
<li>
<p>Add those few users to a new group &lsquo;users2&rsquo;. AND REMOVE them from &lsquo;users&rsquo;</p>
</li>
<li>
<p>DENY &lsquo;users&rsquo; to db_name.T</p>
</li>
<li>
<p>Grant ALL on db_name.T to users2</p>
</li>
</ol>
<p>5.3.2 I want to protect one table db_name.T from one/few users, but all<br>
other people can access it</p>
<ol>
<li>
<p>Add all users to a group &lsquo;users&rsquo;. (assumption: new users will automatically<br>
join this group). And grant &lsquo;users&rsquo; ALL privileges to db_name.*.</p>
</li>
<li>
<p>Add those few users to a new group &lsquo;users2&rsquo;. (Note: those few users will now<br>
belong to 2 groups: users and user2)</p>
</li>
<li>
<p>DENY &lsquo;users2&rsquo; to db_name.T</p>
</li>
</ol>
<h1 id=6-where-to-add-authorization-in-hive>6. Where to add authorization in Hive</h1>
<p>CliDriver and HiveServer. Basically they share the same code. If HiveServer invokes CliDriver, we can just add it into CliDriver. And we also need to make HiveServer be able to support multiple user/connections.<br>
This still does not solve the problem if someone accesses the metastore directly (without going through Hive).</p>
<h1 id=7-implementation>7. Implementation</h1>
<h2 id=71-authenticator-interface>7.1 Authenticator interface</h2>
<p>We only get the user&rsquo;s user name, group names from the authenticator. The authenticator implementations need to provide these information. This is the only interface between authenticator and authorization.</p>
<h2 id=72-authorization>7.2 Authorization</h2>
<p>Authorization decision manager manages a set of authorization provider, and each provider can decide to accept or deny. And it is the decision manager to do the final decision. Can be vote based, or one -1 then deny, or one +1 then accept. Authorization provider decides whether to accept or deny an access based on his own information.</p>
<h1 id=8-metastore-upgrade-script-for-mysql>8. Metastore upgrade script for mysql</h1>
<pre tabindex=0><code>--
-- Table structure for table {{ROLES}}
--

DROP TABLE IF EXISTS {{ROLES}};
CREATE TABLE {{ROLES}} (
  {{ROLE_ID}} bigint(20) NOT NULL,
  {{CREATE_TIME}} int(11) NOT NULL,
  {{OWNER_NAME}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{ROLE_NAME}} varchar(128) character set latin1 collate latin1_bin default NULL,
  PRIMARY KEY  ({{ROLE_ID}}),
  UNIQUE KEY {{ROLEENTITYINDEX}} ({{ROLE_NAME}})
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

--
-- Table structure for table {{ROLE_MAP}}
--

DROP TABLE IF EXISTS {{ROLE_MAP}};
CREATE TABLE {{ROLE_MAP}} (
  {{ROLE_GRANT_ID}} bigint(20) NOT NULL,
  {{ADD_TIME}} int(11) NOT NULL,
  {{GRANT_OPTION}} smallint(6) NOT NULL,
  {{GRANTOR}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{GRANTOR_TYPE}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{PRINCIPAL_NAME}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{PRINCIPAL_TYPE}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{ROLE_ID}} bigint(20) default NULL,
  PRIMARY KEY  ({{ROLE_GRANT_ID}}),
  UNIQUE KEY {{USERROLEMAPINDEX}} ({{PRINCIPAL_NAME}},{{ROLE_ID}},{{GRANTOR}},{{GRANTOR_TYPE}}),
  KEY {{ROLE_MAP_N49}} ({{ROLE_ID}}),
  CONSTRAINT {{ROLE_MAP_FK1}} FOREIGN KEY ({{ROLE_ID}}) REFERENCES {{ROLES}} ({{ROLE_ID}})
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

--
-- Table structure for table {{GLOBAL_PRIVS}}
--

DROP TABLE IF EXISTS {{GLOBAL_PRIVS}};
CREATE TABLE {{GLOBAL_PRIVS}} (
  {{USER_GRANT_ID}} bigint(20) NOT NULL,
  {{CREATE_TIME}} int(11) NOT NULL,
  {{GRANT_OPTION}} smallint(6) NOT NULL,
  {{GRANTOR}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{GRANTOR_TYPE}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{PRINCIPAL_NAME}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{PRINCIPAL_TYPE}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{USER_PRIV}} varchar(128) character set latin1 collate latin1_bin default NULL,
  PRIMARY KEY  ({{USER_GRANT_ID}}),
  UNIQUE KEY {{GLOBALPRIVILEGEINDEX}} ({{PRINCIPAL_NAME}},{{PRINCIPAL_TYPE}},{{USER_PRIV}},{{GRANTOR}},{{GRANTOR_TYPE}})
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

--
-- Table structure for table {{DB_PRIVS}}
--

DROP TABLE IF EXISTS {{DB_PRIVS}};
CREATE TABLE {{DB_PRIVS}} (
  {{DB_GRANT_ID}} bigint(20) NOT NULL,
  {{CREATE_TIME}} int(11) NOT NULL,
  {{DB_ID}} bigint(20) default NULL,
  {{GRANT_OPTION}} smallint(6) NOT NULL,
  {{GRANTOR}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{GRANTOR_TYPE}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{PRINCIPAL_NAME}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{PRINCIPAL_TYPE}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{DB_PRIV}} varchar(128) character set latin1 collate latin1_bin default NULL,
  PRIMARY KEY  ({{DB_GRANT_ID}}),
  UNIQUE KEY {{DBPRIVILEGEINDEX}} ({{DB_ID}},{{PRINCIPAL_NAME}},{{PRINCIPAL_TYPE}},{{DB_PRIV}},{{GRANTOR}},{{GRANTOR_TYPE}}),
  KEY {{DB_PRIVS_N49}} ({{DB_ID}}),
  CONSTRAINT {{DB_PRIVS_FK1}} FOREIGN KEY ({{DB_ID}}) REFERENCES {{DBS}} ({{DB_ID}})
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

--
-- Table structure for table {{TBL_PRIVS}}
--

DROP TABLE IF EXISTS {{TBL_PRIVS}};

CREATE TABLE {{TBL_PRIVS}} (
  {{TBL_GRANT_ID}} bigint(20) NOT NULL,
  {{CREATE_TIME}} int(11) NOT NULL,
  {{GRANT_OPTION}} smallint(6) NOT NULL,
  {{GRANTOR}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{GRANTOR_TYPE}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{PRINCIPAL_NAME}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{PRINCIPAL_TYPE}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{TBL_PRIV}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{TBL_ID}} bigint(20) default NULL,
  PRIMARY KEY  ({{TBL_GRANT_ID}}),
  KEY {{TBL_PRIVS_N49}} ({{TBL_ID}}),
  KEY {{TABLEPRIVILEGEINDEX}} ({{TBL_ID}},{{PRINCIPAL_NAME}},{{PRINCIPAL_TYPE}},{{TBL_PRIV}},{{GRANTOR}},{{GRANTOR_TYPE}}),
  CONSTRAINT {{TBL_PRIVS_FK1}} FOREIGN KEY ({{TBL_ID}}) REFERENCES {{TBLS}} ({{TBL_ID}})
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

--
-- Table structure for table {{PART_PRIVS}}
--

DROP TABLE IF EXISTS {{PART_PRIVS}};

CREATE TABLE {{PART_PRIVS}} (
  {{PART_GRANT_ID}} bigint(20) NOT NULL,
  {{CREATE_TIME}} int(11) NOT NULL,
  {{GRANT_OPTION}} smallint(6) NOT NULL,
  {{GRANTOR}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{GRANTOR_TYPE}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{PART_ID}} bigint(20) default NULL,
  {{PRINCIPAL_NAME}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{PRINCIPAL_TYPE}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{PART_PRIV}} varchar(128) character set latin1 collate latin1_bin default NULL,
  PRIMARY KEY  ({{PART_GRANT_ID}}),
  KEY {{PARTPRIVILEGEINDEX}} ({{PART_ID}},{{PRINCIPAL_NAME}},{{PRINCIPAL_TYPE}},{{PART_PRIV}},{{GRANTOR}},{{GRANTOR_TYPE}}),
  KEY {{PART_PRIVS_N49}} ({{PART_ID}}),
  CONSTRAINT {{PART_PRIVS_FK1}} FOREIGN KEY ({{PART_ID}}) REFERENCES {{PARTITIONS}} ({{PART_ID}})
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

--
-- Table structure for table {{TBL_COL_PRIVS}}
--

DROP TABLE IF EXISTS {{TBL_COL_PRIVS}};
CREATE TABLE {{TBL_COL_PRIVS}} (
  {{TBL_COLUMN_GRANT_ID}} bigint(20) NOT NULL,
  {{COLUMN_NAME}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{CREATE_TIME}} int(11) NOT NULL,
  {{GRANT_OPTION}} smallint(6) NOT NULL,
  {{GRANTOR}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{GRANTOR_TYPE}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{PRINCIPAL_NAME}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{PRINCIPAL_TYPE}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{TBL_COL_PRIV}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{TBL_ID}} bigint(20) default NULL,
  PRIMARY KEY  ({{TBL_COLUMN_GRANT_ID}}),
  KEY {{TABLECOLUMNPRIVILEGEINDEX}} ({{TBL_ID}},{{COLUMN_NAME}},{{PRINCIPAL_NAME}},{{PRINCIPAL_TYPE}},{{TBL_COL_PRIV}},{{GRANTOR}},{{GRANTOR_TYPE}}),
  KEY {{TBL_COL_PRIVS_N49}} ({{TBL_ID}}),
  CONSTRAINT {{TBL_COL_PRIVS_FK1}} FOREIGN KEY ({{TBL_ID}}) REFERENCES {{TBLS}} ({{TBL_ID}})
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

DROP TABLE IF EXISTS {{PART_COL_PRIVS}};
CREATE TABLE {{PART_COL_PRIVS}} (
  {{PART_COLUMN_GRANT_ID}} bigint(20) NOT NULL,
  {{COLUMN_NAME}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{CREATE_TIME}} int(11) NOT NULL,
  {{GRANT_OPTION}} smallint(6) NOT NULL,
  {{GRANTOR}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{GRANTOR_TYPE}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{PART_ID}} bigint(20) default NULL,
  {{PRINCIPAL_NAME}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{PRINCIPAL_TYPE}} varchar(128) character set latin1 collate latin1_bin default NULL,
  {{PART_COL_PRIV}} varchar(128) character set latin1 collate latin1_bin default NULL,
  PRIMARY KEY  ({{PART_COLUMN_GRANT_ID}}),
  KEY {{PART_COL_PRIVS_N49}} ({{PART_ID}}),
  KEY {{PARTITIONCOLUMNPRIVILEGEINDEX}} ({{PART_ID}},{{COLUMN_NAME}},{{PRINCIPAL_NAME}},{{PRINCIPAL_TYPE}},{{PART_COL_PRIV}},{{GRANTOR}},{{GRANTOR_TYPE}}),
  CONSTRAINT {{PART_COL_PRIVS_FK1}} FOREIGN KEY ({{PART_ID}}) REFERENCES {{PARTITIONS}} ({{PART_ID}})
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

</code></pre><hr>
<h1 id=hdfs-permission>HDFS Permission</h1>
<p>The above has a STRONG assumption on the file layer security. Users can easily by-pass the security if the hdfs file permission is open to him. We hope we can easily plug in external authorizations (like HDFS permission/Howl permission) to alter the authorization result or even the rule.</p>
</div>
</div>
<footer class="black-background static-bottom" style=padding:30px>
<div class=row>
<div class=col-3>
<a href=https://www.apache.org/>
<img src=https://hive.apache.org/images/asf_logo.png width=270 height=100 alt="Apache Software Foundation"></a>
</a>
</div>
<div class=col-9>
<p class=footer-text>Apache is a non-profit organization helping open-source
software projects released under the Apache
<a href=https://www.apache.org/licenses/>license</a>
and managed with
<a href=https://www.apache.org/foundation/how-it-works.html>
open governance</a> and
<a href=https://privacy.apache.org/policies/privacy-policy-public.html>
privacy policy</a>. See upcoming
<a href=https://www.apache.org/events/current-event>Apache Events</a>.
If you discover any
<a href=https://www.apache.org/security/>security</a> vulnerabilities, please
report them privately. Finally,
<a href=https://www.apache.org/foundation/sponsorship.html>thanks
</a> to the sponsors who
<a href=https://www.apache.org/foundation/contributing.html>
donate</a> to the Apache Foundation.
</p>
</div>
</div>
<div class="copyright row">
<a href=https://hive.apache.org style=color:grey>
The contents of this website are © 2023 Apache Software Foundation under the terms of the Apache License v2. Apache Hive and its logo are trademarks of the Apache Software Foundation.
</a>
</div>
</footer>
<script src=https://hive.apache.org/js/bootstrap.bundle.min.js></script>
</body>
</html>