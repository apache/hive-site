<!doctype html><html><!doctype html>
<html>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content>
<meta name=author content>
<title>Apache Hive : Replacing the Implementation of Hive CLI Using Beeline</title>
<link rel=icon href=/images/hive.svg sizes=any type=image/svg+xml>
<link rel=stylesheet href=https://hive.apache.org/css/hive-theme.css>
<link rel=stylesheet href=https://hive.apache.org/css/font-awesome.all.min.css>
<link rel=stylesheet href=https://hive.apache.org/css/bootstrap.min.css>
<link rel=stylesheet href=https://hive.apache.org/css/termynal.css>
<link rel=apple-touch-icon sizes=180x180 href=https://hive.apache.org/images/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=https://hive.apache.org/images/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=https://hive.apache.org/images/favicon-16x16.png>
<link rel=manifest href=https://hive.apache.org/images/site.webmanifest>
<link rel=mask-icon href=https://hive.apache.org/images/safari-pinned-tab.svg color=#5bbad5>
<meta name=msapplication-TileColor content="#da532c">
<meta name=theme-color content="#ffffff">
<script>var _paq=window._paq=window._paq||[];_paq.push(['disableCookies']),_paq.push(['trackPageView']),_paq.push(['enableLinkTracking']),function(){var b="https://analytics.apache.org/",c,a,d;_paq.push(['setTrackerUrl',b+'matomo.php']),_paq.push(['setSiteId','30']),c=document,a=c.createElement('script'),d=c.getElementsByTagName('script')[0],a.async=!0,a.src=b+'matomo.js',d.parentNode.insertBefore(a,d)}()</script>
</head>
<body>
<body>
<header>
<menu style=background:#000;margin:0>
<nav class="navbar navbar-expand-lg navbar-dark bg-black">
<div class=container-fluid>
<a href=https://hive.apache.org> <img src=https://hive.apache.org/images/hive.svg width=60 height=35 alt="Apache Software Foundation"></a>
<a class="header-text navbar-brand" href=https://hive.apache.org>Apache Hive</a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span>
</button>
<div class="collapse navbar-collapse" id=navbarSupportedContent>
<ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item dropdown">
<a class=nav-link href=/general/downloads id=navbarDropdown role=button aria-expanded=false>
Releases
</a>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=/Document id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
Documentation
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=/docs/latest/>Latest</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/docs/javadocs/>Javadocs</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/LanguageManual>Language Manual</a></li>
</ul>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=/general id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
General
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=https://www.apache.org/licenses/LICENSE-2.0.html>License</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/general/privacypolicy/>Privacy Policy</a></li>
</ul>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
Development
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=https://hive.apache.org/development/gettingstarted/>Getting Started</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/development/quickstart/>Quickstart with Docker</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/DesignDocs>Design Docs</a></li>
<li><a class=dropdown-item href=https://issues.apache.org/jira/projects/HIVE/issues>Hive JIRA</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/HiveDeveloperFAQ>Hive Developer FAQ</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/Hive+PreCommit+Patch+Testing>Precommit Patch Testing</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/development/versioncontrol/>Version Control</a></li>
</ul>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
Community
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=/community/becomingcommitter/>Becoming A Committer</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/HowToContribute>How To Contribute</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/Home#Home-ResourcesforContributors>Resources for Contributors</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/community/mailinglists/>Mailing Lists</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/community/issuetracking/>Issue Tracking</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/community/people/>People</a></li>
<li>
<hr class=dropdown-divider>
</li>
<li><a class=dropdown-item href=/community/bylaws/>By Laws</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/HowToRelease>How To Release</a></li>
</ul>
</li>
<li class="nav-item dropdown">
<a class=nav-link href=https://hive.blog.apache.org/ id=navbarDropdown role=button aria-expanded=false>
Blogs
</a>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
ASF
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=https://www.apache.org/foundation/contributing.html>Donations</a></li>
<li><a class=dropdown-item href=https://www.apache.org/foundation/sponsorship.html>Sponsorship</a></li>
<li><a class=dropdown-item href=https://www.apache.org/foundation/thanks.html>Thanks</a></li>
<li><a class=dropdown-item href=https://www.apache.org/>Website</a></li>
</ul>
</li>
<li>
<form action=/search method=get class=search-bar>
<input type=search name=q id=search-query placeholder=Search... class=search-input>
<button type=submit class=search-button>Search</button>
</form>
</li>
</ul>
</div>
</div>
</nav>
</menu>
</header>
<div class=content>
<div class=docs>
<h1 id=apache-hive--replacing-the-implementation-of-hive-cli-using-beeline>Apache Hive : Replacing the Implementation of Hive CLI Using Beeline</h1>
<h2 id=heading></h2>
<ul>
<li></li>
<li><a href=#why-replace-the-existing-hive-cli>Why Replace the Existing Hive CLI?</a></li>
<li><a href=#hive-cli-functionality-support>Hive CLI Functionality Support</a>
<ul>
<li><a href=#hive-cli-options-support>Hive CLI Options Support</a></li>
<li><a href=#examples>Examples</a></li>
<li><a href=#hive-cli-interactive-shell-commands-support>Hive CLI Interactive Shell Commands Support</a></li>
<li><a href=#hive-cli-configuration-support>Hive CLI Configuration Support</a></li>
</ul>
</li>
<li><a href=#performance-impacts>Performance Impacts</a></li>
</ul>
<h2 id=why-replace-the-existing-hive-cli>Why Replace the Existing Hive CLI?</h2>
<p><a href=#hive-cli>Hive CLI</a> is a legacy tool which had two main use cases. The first is that it served as a thick client for SQL on Hadoop and the second is that it served as a command line tool for Hive Server (the original Hive server, now often referred to as &ldquo;HiveServer1&rdquo;). Hive Server has been deprecated and removed from the Hive code base as of Hive 1.0.0 (<a href=https://issues.apache.org/jira/browse/HIVE-6977>HIVE-6977</a>) and replaced with HiveServer2 (<a href=https://issues.apache.org/jira/browse/HIVE-2935>HIVE-2935</a>), so the second use case no longer applies. For the first use case, <a href=#beeline>Beeline</a> provides or is supposed to provide equal functionality, yet is implemented differently from Hive CLI.</p>
<p>Ideally, Hive CLI should be deprecated as the Hive community has long recommended using the Beeline plus HiveServer2 configuration; however, because of the wide use of Hive CLI, we instead are replacing Hive CLI&rsquo;s implementation with a new Hive CLI on top of Beeline plus embedded HiveServer2 (<a href=https://issues.apache.org/jira/browse/HIVE-10511>HIVE-10511</a>) so that the Hive community only needs to maintain a single code path. In this way, the new Hive CLI is just an alias to Beeline at both the shell script level and the high code level. The goal is that no or minimal changes are required from existing user scripts using Hive CLI.</p>
<h2 id=hive-cli-functionality-support>Hive CLI Functionality Support</h2>
<p>We use a new Hive CLI on top of Beeline to implement the Hive CLI functionality. Since some existing Hive CLI features are not supported in the new Hive CLI, we are using the old Hive client implementation by default. Use the following command to specify the new Beeline-based Hive CLI tool:</p>
<pre tabindex=0><code>export USE_DEPRECATED_CLI=false
</code></pre><p>Note that the log4j configuration file has been changed to &ldquo;beeline-log4j.properties&rdquo;. </p>
<h3 id=hive-cli-options-support>Hive CLI Options Support</h3>
<p>To get help, run &ldquo;<code>hive -H</code>&rdquo; or &ldquo;<code>hive --help</code>&rdquo;.</p>
<pre tabindex=0><code>usage: hive
 -d,--define &lt;key=value&gt;          Variable subsitution to apply to hive
                                  commands. e.g. -d A=B or --define A=B
    --database &lt;databasename&gt;     Specify the database to use
 -e &lt;quoted-query-string&gt;         SQL from command line
 -f &lt;filename&gt;                    SQL from files
 -H,--help                        Print help information
    --hiveconf &lt;property=value&gt;   Use value for given property
    --hivevar &lt;key=value&gt;         Variable subsitution to apply to hive
                                  commands. e.g. --hivevar A=B
 -i &lt;filename&gt;                    Initialization SQL file
 -S,--silent                      Silent mode in interactive shell
 -v,--verbose                     Verbose mode (echo executed SQL to the
                                  console)
</code></pre><h3 id=examples>Examples</h3>
<ul>
<li>Example of running a query from the command line</li>
</ul>
<pre tabindex=0><code>$HIVE_HOME/bin/hive -e 'select a.foo from pokes a'
</code></pre><ul>
<li>Example of setting Hive configuration variables</li>
</ul>
<pre tabindex=0><code>$HIVE_HOME/bin/hive -e 'select a.foo from pokes a' --hiveconf hive.exec.scratchdir=/opt/my/hive_scratch --hiveconf mapred.reduce.tasks=1
</code></pre><ul>
<li>Example of dumping data out from a query into a file using silent mode</li>
</ul>
<pre tabindex=0><code>$HIVE_HOME/bin/hive -S -e 'select a.foo from pokes a' &gt; a.txt
</code></pre><ul>
<li>Example of running a script non-interactively from local disk</li>
</ul>
<pre tabindex=0><code>$HIVE_HOME/bin/hive -f /home/my/hive-script.sql
</code></pre><ul>
<li>Example of running a script non-interactively from a Hadoop supported filesystem (starting in <a href=https://issues.apache.org/jira/browse/HIVE-7136>Hive 0.14</a>)</li>
</ul>
<pre tabindex=0><code>$HIVE_HOME/bin/hive -f hdfs://&lt;namenode&gt;:&lt;port&gt;/hive-script.sql
</code></pre><h3 id=hive-cli-interactive-shell-commands-support>Hive CLI Interactive Shell Commands Support</h3>
<p>When <code>$HIVE_HOME/bin/hive</code> is run without either the <code>-e</code> or <code>-f</code> option, it enters interactive shell mode.</p>
<p>Use &ldquo;;&rdquo; (semicolon) to terminate commands. Comments in scripts can be specified using the &ldquo;&ndash;&rdquo; prefix.</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>quit exit</td>
<td>Use quit or exit to leave the interactive shell.</td>
</tr>
<tr>
<td>reset</td>
<td>Resets the configuration to the default values (as of Hive 0.10: see <a href=https://issues.apache.org/jira/browse/HIVE-3202>HIVE-3202</a>).</td>
</tr>
<tr>
<td>set =</td>
<td>Sets the value of a particular configuration variable (key). <strong>Note:</strong> If you misspell the variable name, the CLI will not show an error.</td>
</tr>
<tr>
<td>set</td>
<td>Prints a list of configuration variables that are overridden by the user or Hive.</td>
</tr>
<tr>
<td>set -v</td>
<td>Prints all Hadoop and Hive configuration variables.</td>
</tr>
<tr>
<td>add FILE[S] * add JAR[S] * add ARCHIVE[S] *</td>
<td>Adds one or more files, jars, or archives to the list of resources in the distributed cache. See <a href=#hive-resources>Hive Resources</a> for more information.</td>
</tr>
<tr>
<td>add FILE[S] * add JAR[S] * add ARCHIVE[S] *</td>
<td>As of <a href=https://issues.apache.org/jira/browse/HIVE-9664>Hive 1.2.0</a>, adds one or more files, jars or archives to the list of resources in the distributed cache using an <a href=http://ant.apache.org/ivy/>Ivy</a> URL of the form <a href>ivy://group:module:version?query_string</a>. See <a href=#hive-resources>Hive Resources</a>  for more information.</td>
</tr>
<tr>
<td>list FILE[S] list JAR[S] list ARCHIVE[S]</td>
<td>Lists the resources already added to the distributed cache. See <a href=#hive-resources>Hive Resources</a>  for more information.</td>
</tr>
<tr>
<td>list FILE[S] * list JAR[S] * list ARCHIVE[S] *</td>
<td>Checks whether the given resources are already added to the distributed cache or not. See <a href=#hive-resources>Hive Resources</a>  for more information.</td>
</tr>
<tr>
<td>delete FILE[S] * delete JAR[S] * delete ARCHIVE[S] *</td>
<td>Removes the resource(s) from the distributed cache.</td>
</tr>
<tr>
<td>delete FILE[S] * delete JAR[S] * delete ARCHIVE[S] *</td>
<td>As of <a href=https://issues.apache.org/jira/browse/HIVE-9664>Hive 1.2.0</a>, removes the resource(s) which were added using the from the distributed cache. See <a href=#hive-resources>Hive Resources</a> for more information.</td>
</tr>
<tr>
<td>! </td>
<td>Executes a shell command from the Hive shell.</td>
</tr>
<tr>
<td>dfs </td>
<td>Executes a dfs command from the Hive shell.</td>
</tr>
<tr>
<td></td>
<td>Executes a Hive query and prints results to standard output.</td>
</tr>
<tr>
<td>source FILE </td>
<td>Executes a script file inside the CLI.</td>
</tr>
</tbody>
</table>
<p>Examples of shell commands:</p>
<pre tabindex=0><code>hive&gt; source /root/test.sql;
hive&gt; show tables;
test1
test2
hive&gt; exit;
hive&gt; quit;
hive&gt; set;
hive&gt; set hive.cli.print.header=true;
hive&gt; set -v;
hive&gt; reset;
hive&gt; add file /opt/a.txt;
Added resources: [/opt/a.txt]
hive&gt; list files;
/opt/a.txt
hive&gt; delete file /opt/a.txt;
hive&gt; add jar /usr/share/vnc/classes/vncviewer.jar;
Added [/usr/share/vnc/classes/vncviewer.jar]to class path
Added resources:[/usr/share/vnc/classes/vncviewer.jar]
hive&gt; list jars;
/usr/share/vnc/classes/vncviewer.jar
hive&gt; delete jar /usr/share/vnc/classes/vncviewer.jar;
hive&gt; !ls;
bin
conf
hive&gt; dfs -ls / ;
Found 2 items
drwx-wx-wx  - root supergroup  0   2015-08-12 19:06 /tmp
drwxr-xr-x  - root supergroup  0   2015-08-12 19:43 /user
hive&gt; select * from pokes; 
OK
pokes.foo   pokes.bar
238         val_238
86          val_86
311         val_311
hive&gt;source /opt/s.sql;
</code></pre><h3 id=hive-cli-configuration-support>Hive CLI Configuration Support</h3>
<table>
<thead>
<tr>
<th>Configuration Name</th>
<th>Supported in New Hive CLI</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>hive.cli.print.header</td>
<td>Yes</td>
<td>Whether to print the names of the columns in query output. <a href=https://issues.apache.org/jira/browse/HIVE-11624>HIVE-11624</a></td>
</tr>
<tr>
<td>hive.cli.errors.ignore</td>
<td>Yes</td>
<td>Whether to force execution of a script when errors occurred. <a href=https://issues.apache.org/jira/browse/HIVE-11191>HIVE-11191</a></td>
</tr>
<tr>
<td>hive.cli.prompt</td>
<td>Yes</td>
<td>Command line prompt configuration value. Other hiveconf can be used in this configuration value. <a href=https://issues.apache.org/jira/browse/HIVE-11226>HIVE-11226</a></td>
</tr>
<tr>
<td>hive.cli.pretty.output.num.cols</td>
<td>Yes</td>
<td>The number of columns to use when formatting output generated by the DESCRIBE PRETTY <em>table_name</em> command. <a href=https://issues.apache.org/jira/browse/HIVE-11779>HIVE-11779</a></td>
</tr>
<tr>
<td>hive.cli.print.current.db</td>
<td>Yes</td>
<td>Whether to include the current database in the Hive prompt. <a href=https://issues.apache.org/jira/browse/HIVE-11637>HIVE-11637</a></td>
</tr>
</tbody>
</table>
<h2 id=performance-impacts>Performance Impacts</h2>
<p>Using the JMH to measure the average time cost when retrieving a data set, we have the following results.</p>
<pre tabindex=0><code>Benchmark                                                       Mode  Samples           Score   Error  Units
o.a.h.b.c.CliBench.BeeLineDriverBench.testSQLWithInitialFile    avgt        1  1713326099.000 ?  NaN  ns/op
o.a.h.b.c.CliBench.CliDriverBench.testSQLWithInitialFile        avgt        1  1852995786.000 ?  NaN  ns/op
</code></pre><p>The lower the score the better since we are evaluating the time cost. There is no clear performance gap in terms of retrieving data.</p>
<p> </p>
<p> </p>
</div>
</div>
<footer class="black-background static-bottom" style=padding:30px>
<div class=row>
<div class=col-3>
<a href=https://www.apache.org/>
<img src=https://hive.apache.org/images/asf_logo.png width=270 height=100 alt="Apache Software Foundation"></a>
</a>
</div>
<div class=col-9>
<p class=footer-text>Apache is a non-profit organization helping open-source
software projects released under the Apache
<a href=https://www.apache.org/licenses/>license</a>
and managed with
<a href=https://www.apache.org/foundation/how-it-works.html>
open governance</a> and
<a href=https://privacy.apache.org/policies/privacy-policy-public.html>
privacy policy</a>. See upcoming
<a href=https://www.apache.org/events/current-event>Apache Events</a>.
If you discover any
<a href=https://www.apache.org/security/>security</a> vulnerabilities, please
report them privately. Finally,
<a href=https://www.apache.org/foundation/sponsorship.html>thanks
</a> to the sponsors who
<a href=https://www.apache.org/foundation/contributing.html>
donate</a> to the Apache Foundation.
</p>
</div>
</div>
<div class="copyright row">
<a href=https://hive.apache.org style=color:grey>
The contents of this website are © 2023 Apache Software Foundation under the terms of the Apache License v2. Apache Hive and its logo are trademarks of the Apache Software Foundation.
</a>
</div>
</footer>
<script src=https://hive.apache.org/js/bootstrap.bundle.min.js></script>
</body>
</html>