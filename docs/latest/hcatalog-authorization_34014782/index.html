<!doctype html><html><!doctype html>
<html>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content>
<meta name=author content>
<title>Apache Hive : HCatalog Authorization</title>
<link rel=icon href=/images/hive.svg sizes=any type=image/svg+xml>
<link rel=stylesheet href=https://hive.apache.org/css/hive-theme.css>
<link rel=stylesheet href=https://hive.apache.org/css/font-awesome.all.min.css>
<link rel=stylesheet href=https://hive.apache.org/css/bootstrap.min.css>
<link rel=stylesheet href=https://hive.apache.org/css/termynal.css>
<link rel=apple-touch-icon sizes=180x180 href=https://hive.apache.org/images/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=https://hive.apache.org/images/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=https://hive.apache.org/images/favicon-16x16.png>
<link rel=manifest href=https://hive.apache.org/images/site.webmanifest>
<link rel=mask-icon href=https://hive.apache.org/images/safari-pinned-tab.svg color=#5bbad5>
<meta name=msapplication-TileColor content="#da532c">
<meta name=theme-color content="#ffffff">
<script>var _paq=window._paq=window._paq||[];_paq.push(['disableCookies']),_paq.push(['trackPageView']),_paq.push(['enableLinkTracking']),function(){var b="https://analytics.apache.org/",c,a,d;_paq.push(['setTrackerUrl',b+'matomo.php']),_paq.push(['setSiteId','30']),c=document,a=c.createElement('script'),d=c.getElementsByTagName('script')[0],a.async=!0,a.src=b+'matomo.js',d.parentNode.insertBefore(a,d)}()</script>
</head>
<body>
<body>
<header>
<menu style=background:#000;margin:0>
<nav class="navbar navbar-expand-lg navbar-dark bg-black">
<div class=container-fluid>
<a href=https://hive.apache.org> <img src=https://hive.apache.org/images/hive.svg width=60 height=35 alt="Apache Software Foundation"></a>
<a class="header-text navbar-brand" href=https://hive.apache.org>Apache Hive</a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span>
</button>
<div class="collapse navbar-collapse" id=navbarSupportedContent>
<ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item dropdown">
<a class=nav-link href=/general/downloads id=navbarDropdown role=button aria-expanded=false>
Releases
</a>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=/Document id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
Documentation
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=/docs/latest/>Latest</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/docs/javadocs/>Javadocs</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/LanguageManual>Language Manual</a></li>
</ul>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=/general id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
General
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=https://www.apache.org/licenses/LICENSE-2.0.html>License</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/general/privacypolicy/>Privacy Policy</a></li>
</ul>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
Development
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=https://hive.apache.org/development/gettingstarted/>Getting Started</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/development/quickstart/>Quickstart with Docker</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/DesignDocs>Design Docs</a></li>
<li><a class=dropdown-item href=https://issues.apache.org/jira/projects/HIVE/issues>Hive JIRA</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/HiveDeveloperFAQ>Hive Developer FAQ</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/Hive+PreCommit+Patch+Testing>Precommit Patch Testing</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/development/versioncontrol/>Version Control</a></li>
</ul>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
Community
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=/community/becomingcommitter/>Becoming A Committer</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/HowToContribute>How To Contribute</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/Home#Home-ResourcesforContributors>Resources for Contributors</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/community/mailinglists/>Mailing Lists</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/community/issuetracking/>Issue Tracking</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/community/people/>People</a></li>
<li>
<hr class=dropdown-divider>
</li>
<li><a class=dropdown-item href=/community/bylaws/>By Laws</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/HowToRelease>How To Release</a></li>
</ul>
</li>
<li class="nav-item dropdown">
<a class=nav-link href=https://hive.blog.apache.org/ id=navbarDropdown role=button aria-expanded=false>
Blogs
</a>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
ASF
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=https://www.apache.org/foundation/contributing.html>Donations</a></li>
<li><a class=dropdown-item href=https://www.apache.org/foundation/sponsorship.html>Sponsorship</a></li>
<li><a class=dropdown-item href=https://www.apache.org/foundation/thanks.html>Thanks</a></li>
<li><a class=dropdown-item href=https://www.apache.org/>Website</a></li>
</ul>
</li>
<li>
<form action=/search method=get class=search-bar>
<input type=search name=q id=search-query placeholder=Search... class=search-input>
<button type=submit class=search-button>Search</button>
</form>
</li>
</ul>
</div>
</div>
</nav>
</menu>
</header>
<div class=content>
<div class=docs>
<h1 id=apache-hive--hcatalog-authorization>Apache Hive : HCatalog Authorization</h1>
<h1 id=storage-based-authorization>Storage Based Authorization</h1>
<ul>
<li><a href=#storage-based-authorization>Storage Based Authorization</a>
<ul>
<li><a href=#default-authorization-model-of-hive>Default Authorization Model of Hive</a></li>
<li><a href=#storage-system-based-authorization-model>Storage-System Based Authorization Model</a>
<ul>
<li><a href=#minimum-permissions>Minimum Permissions</a></li>
<li><a href=#unused-ddl-for-permissions>Unused DDL for Permissions</a></li>
</ul>
</li>
<li><a href=#configuring-storage-system-based-authorization>Configuring Storage-System Based Authorization</a></li>
<li><a href=#creating-new-tables-or-databases>Creating New Tables or Databases</a></li>
<li><a href=#known-issues>Known Issues</a></li>
</ul>
</li>
</ul>
<h2 id=default-authorization-model-of-hive>Default Authorization Model of Hive</h2>
<p>The default authorization model of Hive supports a traditional RDBMS style of authorization based on users, groups and roles and granting them permissions to do operations on database or table. It is described in more detail in <a href=https://hive.apache.org/docs/latest/languagemanual-authorization_27362032/>Hive Authorization</a> and <a href=https://hive.apache.org/docs/latest/45876173/>Hive deprecated authorization mode / Legacy Mode</a>.</p>
<p>This RDBMS style of authorization is not very suitable for the typical use cases in Hadoop because of the following differences in implementation:</p>
<ol>
<li>Unlike a traditional RDBMS, Hive is not in complete control of all data underneath it. The data is stored in a number of files, and the file system has an independent authorization system.</li>
<li>Also unlike a traditional RDBMS which doesn’t allow other programs to access the data directly, people tend to use other applications that read or write directly into files or directories that get used with Hive.</li>
</ol>
<p>This creates problem scenarios like:</p>
<ol>
<li>You grant permissions to a user, but the user can’t access the database or file system because they don’t have file system permissions.</li>
<li>You remove permissions for a user, but the user can still access the data directly through the file system, because they have file system permissions.</li>
</ol>
<h2 id=storage-system-based-authorization-model>Storage-System Based Authorization Model</h2>
<p>The Hive community realizes that there might not be a one-size-fits-all authorization model, so it has support for alternative authorization models to be plugged in.</p>
<p>In the HCatalog package, we have introduced implementation of an authorization interface that uses the permissions of the underlying file system (or in general, the storage backend) as the basis of permissions on each database, table or partition.</p>
<p>Note</p>
<p>This feature is also available in Hive on the metastore-side, starting with release 0.10.0 (see <a href=https://hive.apache.org/docs/latest/storage-based-authorization-in-the-metastore-server_45876440/>Storage Based Authorization in the Metastore Server</a> in the Hive documentation). Starting in Hive 0.12.0 it also runs on the client side (<a href=https://issues.apache.org/jira/browse/HIVE-5048>HIVE-5048</a> and <a href=https://issues.apache.org/jira/browse/HIVE-5402>HIVE-5402</a>).</p>
<p>In Hive, when a file system is used for storage, there is a directory corresponding to a database or a table. With this authorization model, the read/write permissions a user or group has for this directory determine the permissions a user has on the database or table. In the case of other storage systems such as HBase, the authorization of equivalent entities in the system will be done using the system’s authorization mechanism to determine the permissions in Hive.</p>
<p>For example, an alter table operation would check if the user has permissions on the table directory before allowing the operation, even if it might not change anything on the file system.</p>
<p>A user would need write access to the corresponding entity on the storage system to do any type of action that can modify the state of the database or table. The user needs read access to be able to do any non-modifying action on the database or table.</p>
<p>When the database or table is backed by a file system that has a Unix/POSIX-style permissions model (like HDFS), there are read(r) and write(w) permissions you can set for the owner user, group and ‘other’.</p>
<p>Details of HDFS permissions are given at <code>ht``tp://hadoop.apache.org/docs/r</code><em>x.x.x</em><code>/hdfs_permissions_guide.html</code>, for example:</p>
<ul>
<li><a href=http://hadoop.apache.org/docs/r1.0.4/hdfs_permissions_guide.html>HDFS Permissions Guide (release 1.0.4)</a></li>
<li><a href=http://hadoop.apache.org/docs/r1.2.1/hdfs_permissions_guide.html>HDFS Permissions Guide (release 1.2.1)</a></li>
</ul>
<p><strong>Note:</strong> Support for <a href=http://hadoop.apache.org/docs/r2.4.0/hadoop-project-dist/hadoop-hdfs/HdfsPermissionsGuide.html#ACLs_Access_Control_Lists>HDFS ACL</a> (introduced in Apache Hadoop 2.4) is not available in the released versions of Hive.  Which means, that it checks only the traditional rwx style permissions to determine if a user can write to the file system. The support for ACL is available in Hive trunk <a href=https://issues.apache.org/jira/browse/HIVE-7583>HIVE-7583</a>, which will be available in Hive 0.14.  </p>
<p>Links to documentation for different releases of Hadoop can be found here: <a href=http://hadoop.apache.org/docs/>http://hadoop.apache.org/docs/</a>.</p>
<p><strong>Note</strong>: If <a href=https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-hive.warehouse.subdir.inherit.perms>hive.warehouse.subdir.inherit.perms</a> is enabled, permissions and ACL&rsquo;s for Hive-created files and directories will be set via the following <a href=https://hive.apache.org/docs/latest/permission-inheritance-in-hive_48203008/>permission inheritance</a> rules.</p>
<p>The file system’s logic for determining if a user has permission on the directory or file will be used by Hive. </p>
<h3 id=minimum-permissions>Minimum Permissions</h3>
<p>The following table shows the minimum permissions required for Hive operations under this authorization model:</p>
<table>
<thead>
<tr>
<th>Operation</th>
<th>Database Read Access</th>
<th>Database Write Access</th>
<th>Table Read Access</th>
<th>Table Write Access</th>
</tr>
</thead>
<tbody>
<tr>
<td>LOAD</td>
<td> </td>
<td> </td>
<td> </td>
<td>X</td>
</tr>
<tr>
<td>EXPORT</td>
<td> </td>
<td> </td>
<td>X</td>
<td> </td>
</tr>
<tr>
<td>IMPORT</td>
<td> </td>
<td> </td>
<td> </td>
<td>X</td>
</tr>
<tr>
<td>CREATE TABLE</td>
<td> </td>
<td>X</td>
<td> </td>
<td> </td>
</tr>
<tr>
<td>CREATE TABLE AS SELECT</td>
<td> </td>
<td>X</td>
<td>X source table</td>
<td> </td>
</tr>
<tr>
<td>DROP TABLE</td>
<td> </td>
<td>X</td>
<td> </td>
<td> </td>
</tr>
<tr>
<td>SELECT</td>
<td> </td>
<td> </td>
<td>X</td>
<td> </td>
</tr>
<tr>
<td>ALTER TABLE</td>
<td> </td>
<td> </td>
<td> </td>
<td>X</td>
</tr>
<tr>
<td>SHOW TABLES</td>
<td>X</td>
<td> </td>
<td> </td>
<td> </td>
</tr>
</tbody>
</table>
<p><strong>Caution:</strong> Hive&rsquo;s current implementation of this authorization model does not prevent malicious users from doing bad things. See the <a href=#known-issues>Known Issues</a> section below.</p>
<h3 id=unused-ddl-for-permissions>Unused DDL for Permissions</h3>
<p>DDL statements that manage permissions for Hive&rsquo;s default authorization model do not have any effect on permissions in the storage-based model.</p>
<p>Caution</p>
<p>All GRANT and REVOKE statements for users, groups, and roles are ignored. See the <a href=#known-issues>Known Issues</a> section below.</p>
<h2 id=configuring-storage-system-based-authorization>Configuring Storage-System Based Authorization</h2>
<p>The implementation of the file-system based authorization model is available through an authorization provider called StorageBasedAuthorizationProvider that is part of Hive. (Support for this was added to the Hive package in release 0.10.0 – see <a href=https://issues.apache.org/jira/browse/HIVE-3705>HIVE-3705</a> and <a href=https://hive.apache.org/docs/latest/storage-based-authorization-in-the-metastore-server_45876440/>Storage Based Authorization in the Metastore Server</a>.)</p>
<p>Version</p>
<p>An earlier implementation of this called HdfsAuthorizationProvider used to exist in the HCatalog package, but has since been deprecated and removed as of Hive 0.14 trunk. If your configuration indicates use of HdfsAuthorizationProvider, please update to this configuration instead.</p>
<p>The following entries need to be added to <code>hive-site.xml</code> to enable authorization:</p>
<pre tabindex=0><code>  &lt;property&gt;
    &lt;name&gt;hive.security.authorization.enabled&lt;/name&gt;
    &lt;value&gt;true&lt;/value&gt;
    &lt;description&gt;enable or disable the hive client authorization&lt;/description&gt;
  &lt;/property&gt;

  &lt;property&gt;
    &lt;name&gt;hive.security.authorization.manager&lt;/name&gt;
    &lt;value&gt;org.apache.hadoop.hive.ql.security.authorization.StorageBasedAuthorizationProvider&lt;/value&gt;
    &lt;description&gt;the hive client authorization manager class name.
    The user defined authorization class should implement interface
    org.apache.hadoop.hive.ql.security.authorization.HiveAuthorizationProvider.
    &lt;/description&gt;
  &lt;/property&gt;

</code></pre><p>To disable authorization, set <code>hive.security.authorization.enabled</code> to false. To use the default authorization model of Hive, don’t set the <code>hive.security.authorization.manager</code> property.</p>
<h2 id=creating-new-tables-or-databases>Creating New Tables or Databases</h2>
<p>To create new tables or databases with appropriate permissions, you can either use the Hive command line to create the table/database and then modify the permissions using a file system operation, or use the HCatalog command line (<code>hcat</code>) to create the database/table.</p>
<p>The HCatalog command line tool uses the same syntax as Hive, and will create the table or database with a corresponding directory being owned by the user creating it, and a group corresponding to the “-g” argument and permissions specified in the “-p” argument.</p>
<h2 id=known-issues>Known Issues</h2>
<ol>
<li>Some metadata operations (mostly read operations) do not check for authorization. See <a href=https://issues.apache.org/jira/browse/HIVE-3009>https://issues.apache.org/jira/browse/HIVE-3009</a>.</li>
<li>The current implementation of Hive performs the authorization checks in the client. This means that malicious users can circumvent these checks.</li>
<li>A different authorization provider (StorageDelegationAuthorizationProvider) needs to be used for working with HBase tables as well. But that is not well tested.</li>
<li>Partition files and directories added by a Hive query don’t inherit permissions from the table. This means that even if you grant permissions for a group to access a table, new partitions will have read permissions only for the owner, if the default umask for the cluster is configured as such. See <a href=https://issues.apache.org/jira/browse/HIVE-3094>https://issues.apache.org/jira/browse/HIVE-3094</a>. A separate &ldquo;<code>hdfs chmod</code>&rdquo; command will be necessary to modify the permissions.</li>
<li>Although DDL statements for managing permissions have no effect in storage-based authorization, currently they do not return error messages. See <a href=https://issues.apache.org/jira/browse/HIVE-3010>https://issues.apache.org/jira/browse/HIVE-3010</a>.</li>
</ol>
<p> </p>
<p><strong>Navigation Links</strong>
Previous: <a href=https://hive.apache.org/docs/latest/hcatalog-notification_34014558/>Notification</a></p>
<p>Hive documents: <a href=https://hive.apache.org/docs/latest/languagemanual-authorization_27362032/>Authorization</a> and <a href=https://hive.apache.org/docs/latest/storage-based-authorization-in-the-metastore-server_45876440/>Storage Based Authorization in the Metastore Server</a></p>
<p>General: <a href=https://hive.apache.org/docs/latest/hcatalog_33299065/>HCatalog Manual</a> – <a href=https://hive.apache.org/docs/latest/webhcat_33299069/>WebHCat Manual</a> – <a href=https://hive.apache.org/docs/latest/home_27362069/>Hive Wiki Home</a> – <a href=http://hive.apache.org/>Hive Project Site</a></p>
</div>
</div>
<footer class="black-background static-bottom" style=padding:30px>
<div class=row>
<div class=col-3>
<a href=https://www.apache.org/>
<img src=https://hive.apache.org/images/asf_logo.png width=270 height=100 alt="Apache Software Foundation"></a>
</a>
</div>
<div class=col-9>
<p class=footer-text>Apache is a non-profit organization helping open-source
software projects released under the Apache
<a href=https://www.apache.org/licenses/>license</a>
and managed with
<a href=https://www.apache.org/foundation/how-it-works.html>
open governance</a> and
<a href=https://privacy.apache.org/policies/privacy-policy-public.html>
privacy policy</a>. See upcoming
<a href=https://www.apache.org/events/current-event>Apache Events</a>.
If you discover any
<a href=https://www.apache.org/security/>security</a> vulnerabilities, please
report them privately. Finally,
<a href=https://www.apache.org/foundation/sponsorship.html>thanks
</a> to the sponsors who
<a href=https://www.apache.org/foundation/contributing.html>
donate</a> to the Apache Foundation.
</p>
</div>
</div>
<div class="copyright row">
<a href=https://hive.apache.org style=color:grey>
The contents of this website are © 2023 Apache Software Foundation under the terms of the Apache License v2. Apache Hive and its logo are trademarks of the Apache Software Foundation.
</a>
</div>
</footer>
<script src=https://hive.apache.org/js/bootstrap.bundle.min.js></script>
</body>
</html>