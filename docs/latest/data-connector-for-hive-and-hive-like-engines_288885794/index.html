<!doctype html><html><!doctype html>
<html>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content>
<meta name=author content>
<title>Apache Hive : Data Connector for Hive and Hive-like engines</title>
<link rel=icon href=/images/hive.svg sizes=any type=image/svg+xml>
<link rel=stylesheet href=https://hive.apache.org/css/hive-theme.css>
<link rel=stylesheet href=https://hive.apache.org/css/font-awesome.all.min.css>
<link rel=stylesheet href=https://hive.apache.org/css/bootstrap.min.css>
<link rel=stylesheet href=https://hive.apache.org/css/termynal.css>
<link rel=apple-touch-icon sizes=180x180 href=https://hive.apache.org/images/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=https://hive.apache.org/images/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=https://hive.apache.org/images/favicon-16x16.png>
<link rel=manifest href=https://hive.apache.org/images/site.webmanifest>
<link rel=mask-icon href=https://hive.apache.org/images/safari-pinned-tab.svg color=#5bbad5>
<meta name=msapplication-TileColor content="#da532c">
<meta name=theme-color content="#ffffff">
<script>var _paq=window._paq=window._paq||[];_paq.push(['disableCookies']),_paq.push(['trackPageView']),_paq.push(['enableLinkTracking']),function(){var b="https://analytics.apache.org/",c,a,d;_paq.push(['setTrackerUrl',b+'matomo.php']),_paq.push(['setSiteId','30']),c=document,a=c.createElement('script'),d=c.getElementsByTagName('script')[0],a.async=!0,a.src=b+'matomo.js',d.parentNode.insertBefore(a,d)}()</script>
</head>
<body>
<body>
<header>
<menu style=background:#000;margin:0>
<nav class="navbar navbar-expand-lg navbar-dark bg-black">
<div class=container-fluid>
<a href=https://hive.apache.org> <img src=https://hive.apache.org/images/hive.svg width=60 height=35 alt="Apache Software Foundation"></a>
<a class="header-text navbar-brand" href=https://hive.apache.org>Apache Hive</a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span>
</button>
<div class="collapse navbar-collapse" id=navbarSupportedContent>
<ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item dropdown">
<a class=nav-link href=/general/downloads id=navbarDropdown role=button aria-expanded=false>
Releases
</a>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=/Document id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
Documentation
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=/docs/latest/>Latest</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/docs/javadocs/>Javadocs</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/LanguageManual>Language Manual</a></li>
</ul>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=/general id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
General
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=https://www.apache.org/licenses/LICENSE-2.0.html>License</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/general/privacypolicy/>Privacy Policy</a></li>
</ul>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
Development
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=https://hive.apache.org/development/gettingstarted/>Getting Started</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/development/quickstart/>Quickstart with Docker</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/DesignDocs>Design Docs</a></li>
<li><a class=dropdown-item href=https://issues.apache.org/jira/projects/HIVE/issues>Hive JIRA</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/HiveDeveloperFAQ>Hive Developer FAQ</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/Hive+PreCommit+Patch+Testing>Precommit Patch Testing</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/development/versioncontrol/>Version Control</a></li>
</ul>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
Community
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=/community/becomingcommitter/>Becoming A Committer</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/HowToContribute>How To Contribute</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/Home#Home-ResourcesforContributors>Resources for Contributors</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/community/mailinglists/>Mailing Lists</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/community/issuetracking/>Issue Tracking</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/community/people/>People</a></li>
<li>
<hr class=dropdown-divider>
</li>
<li><a class=dropdown-item href=/community/bylaws/>By Laws</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/HowToRelease>How To Release</a></li>
</ul>
</li>
<li class="nav-item dropdown">
<a class=nav-link href=https://hive.blog.apache.org/ id=navbarDropdown role=button aria-expanded=false>
Blogs
</a>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
ASF
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=https://www.apache.org/foundation/contributing.html>Donations</a></li>
<li><a class=dropdown-item href=https://www.apache.org/foundation/sponsorship.html>Sponsorship</a></li>
<li><a class=dropdown-item href=https://www.apache.org/foundation/thanks.html>Thanks</a></li>
<li><a class=dropdown-item href=https://www.apache.org/>Website</a></li>
</ul>
</li>
<li>
<form action=/search method=get class=search-bar>
<input type=search name=q id=search-query placeholder=Search... class=search-input>
<button type=submit class=search-button>Search</button>
</form>
</li>
</ul>
</div>
</div>
</nav>
</menu>
</header>
<div class=content>
<div class=docs>
<h1 id=apache-hive--data-connector-for-hive-and-hive-like-engines>Apache Hive : Data Connector for Hive and Hive-like engines</h1>
<h3 id=what-is-a-data-connector>What is a Data connector?</h3>
<p>Data connectors (referred to as &ldquo;connector&rdquo; in Hive Query Language) are top level objects in Hive where users can define a set of properties required to be able to connect to an external datasource from hive. This document illustrates example of the data connector framework can be used to do SQL query federation between two distinct &ldquo;hive&rdquo; clusters/installations or between Hive and another hive-like compute engines (eg: EMR).</p>
<h3 id=hivejdbc-type-data-connector>HIVEJDBC type Data connector</h3>
<p>Apache Hive now has a connector to plugin in multiple hive and hive like sources. <a href=https://issues.apache.org/jira/browse/HIVE-27597>HIVE-27597</a> adds a JDBC based connector of type &ldquo;<em><strong>HIVEJDBC</strong></em>&rdquo;. Similar to the other data connectors, this connector needs a URL, Driver name, credentials etc to be defined as part of the connector definition. Once defined, users can use the same connector object to map multiple databases from the remote datasource to local hive metastore.</p>
<p>HIVEJDBC connector requires the following values</p>
<ul>
<li>Name → local name to be able to reference the connector with. This name is shown in &ldquo;show connectors&rdquo; and will be used in connector DDLs like drop/alter and also in &ldquo;create remote database ..&rdquo; statements.</li>
<li>TYPE → &ldquo;HIVEJDBC&rdquo; so Hive Metastore knows that Connector class to use.</li>
<li>URL → JDBC URL for the remote HiveServer instance.</li>
<li>DCPROPERTIES → This is a freeform list that contains other info like credentials and other optional properties. These properties will be passed onto the table definitions for the databases created using this connector</li>
</ul>
<p><strong>Note:</strong> Data Connectors in Hive are currently only used to read the data from remote sources. Write operations are not supported.</p>
<h3 id=how-do-i-use-it>How do I use it?</h3>
<ol>
<li>Create a connector first.</li>
</ol>
<pre tabindex=0><code>    CREATE CONNECTOR hiveserver_connector TYPE 'hivejdbc' URL 'jdbc:hive2://&lt;maskedhost&gt;:10000'   
     WITH DCPROPERTIES (&quot;hive.sql.dbcp.username&quot;=&quot;hive&quot;, &quot;hive.sql.dbcp.password&quot;=&quot;hive&quot;);  
  

</code></pre><ol start=2>
<li>Create a database of type REMOTE in hive using the connector from Step 1. This maps a remote database named &ldquo;<code>*default*</code>&rdquo; to a hive database named &ldquo;<em><code>hiveserver_remote</code></em>&rdquo; in hive.</li>
</ol>
<pre tabindex=0><code>         CREATE REMOTE DATABASE hiveserver_remote USING hiveserver_connector   
         WITH DBPROPERTIES (&quot;connector.remoteDbName&quot;=&quot;default&quot;);  
     
   3. Use the tables in REMOTE database much like the JDBC-storagehandler based tables in hive. One big difference   
      is that the metadata for these tables are never persisted in hive. Currently, create/alter/drop table DDLs   
      are not supported in REMOTE databases.   
  
     0: jdbc:hive2://localhost:10000&gt; USE hiveserver_remote;
</code></pre><p><code>0: jdbc:hive2://localhost:10000> **describe formatted test_emr_tbl;**</code></p>
<pre tabindex=0><code>+-------------------------------+-------------------------------------------------+----------------------------------------------------+  
|           col_name            |                    data_type                    |                      comment                       |  
+-------------------------------+-------------------------------------------------+----------------------------------------------------+  
| tblkey                        | int                                             | from deserializer                                  |  
| descr                         | string                                          | from deserializer                                  |  
|                               | NULL                                            | NULL                                               |  
| # Detailed Table Information  | NULL                                            | NULL                                               |  
| Database:                     | emr_db                                          | NULL                                               |  
| OwnerType:                    | USER                                            | NULL                                               |  
| Owner:                        | null                                            | NULL                                               |  
| CreateTime:                   | UNKNOWN                                         | NULL                                               |  
| LastAccessTime:               | UNKNOWN                                         | NULL                                               |  
| Retention:                    | 0                                               | NULL                                               |  
| Location:                     | [file:/tmp/hive/warehouse/external/test_emr_tbl](http://file/tmp/hive/warehouse/external/test_emr_tbl)  | NULL                                               |  
| Table Type:                   | EXTERNAL_TABLE                                  | NULL                                               |  
| Table Parameters:             | NULL                                            | NULL                                               |  
|                               | EXTERNAL                                        | TRUE                                               |  
|                               | hive.sql.database.type                          | HIVE                                               |  
|                               | hive.sql.dbcp.password                          |                                                    |  
|                               | hive.sql.dbcp.username                          | hive                                               |  
|                               | hive.sql.jdbc.driver                            | org.apache.hive.jdbc.HiveDriver                    |  
|                               | hive.sql.jdbc.url                               | jdbc:hive2://&lt;maskedIP&gt;.compute-1.amazonaws.com:10000 |  
|                               | hive.sql.schema                                 | default                                            |  
|                               | hive.sql.table                                  | test_emr_tbl                                       |  
|                               | storage_handler                                 | org.apache.hive.storage.jdbc.JdbcStorageHandler    |  
|                               | NULL                                            | NULL                                               |  
| # Storage Information         | NULL                                            | NULL                                               |  
| SerDe Library:                | org.apache.hive.storage.jdbc.JdbcSerDe          | NULL                                               |  
| InputFormat:                  | org.apache.hive.storage.jdbc.JdbcInputFormat    | NULL                                               |  
| OutputFormat:                 | org.apache.hive.storage.jdbc.JdbcOutputFormat   | NULL                                               |  
| Compressed:                   | No                                              | NULL                                               |  
| Num Buckets:                  | 0                                               | NULL                                               |  
| Bucket Columns:               | []                                              | NULL                                               |  
| Sort Columns:                 | []                                              | NULL                                               |  
| Storage Desc Params:          | NULL                                            | NULL                                               |  
|                               | serialization.format                            | 1                                                  |  
+-------------------------------+-------------------------------------------------+----------------------------------------------------+
</code></pre><p><code>33 rows selected (6.099 seconds)</code></p>
<pre tabindex=0><code>    4. Offload the remote table to local cluster, run CTAS (example below pulls in all the data into the local table,   
       but you can pull in select columns and rows by applying predicates)
</code></pre><p><code>0: jdbc:hive2://localhost:10000> **create table default.emr_clone as select * from test_emr_tbl;**</code></p>
<p><code>INFO  : Completed executing command(queryId=ngangam_20240129182608_db20e2bb-1db3-473f-9564-0d81b01228bc); Time taken: 6.492 seconds</code></p>
<p><code>INFO  : OK</code></p>
<p><code>2 rows affected (14.802 seconds)</code></p>
<p><strong><code>0: jdbc:hive2://localhost:10000> select count(*) from default.emr_clone;</code></strong></p>
<p><code>INFO  : Completed executing command(queryId=ngangam_20240129182647_7544c9d1-c68b-4a34-b6b0-910945a1dba5); Time taken: 2.344 seconds</code></p>
<p><code>INFO  : OK</code></p>
<pre tabindex=0><code>     +------+  
     | _c0  |  
     +------+  
     | 2    |  
     +------+
</code></pre><p><code>1 row selected (8.795 seconds)</code></p>
<pre tabindex=0><code>  
    5. To fetch data from the remote tables, run SELECT queries using column spec and predicates as you would   
       normally with any SQL tables.
</code></pre><p>0: jdbc:hive2://localhost:10000> <strong>select * from test_emr_tbl where tblkey > 1;</strong></p>
<p>INFO  : Completed executing command(queryId=ngangam_20240129191217_79b9e874-197d-4c31-8164-1ec2397bbff7); Time taken: 0.001 seconds</p>
<p>INFO  : OK</p>
<pre tabindex=0><code>     +----------------------+---------------------+  
     | test_emr_tbl.tblkey  | test_emr_tbl.descr  |  
     +----------------------+---------------------+  
     | 2                    | test 2              |  
     +----------------------+---------------------+
</code></pre><p>1 row selected (8.238 seconds)</p>
<pre tabindex=0><code>  
6. Join with local hive tables, run SELECT queries joining multiple tables (local or remote) as you would   
   normally with any SQL tables.
</code></pre>
</div>
</div>
<footer class="black-background static-bottom" style=padding:30px>
<div class=row>
<div class=col-3>
<a href=https://www.apache.org/>
<img src=https://hive.apache.org/images/asf_logo.png width=270 height=100 alt="Apache Software Foundation"></a>
</a>
</div>
<div class=col-9>
<p class=footer-text>Apache is a non-profit organization helping open-source
software projects released under the Apache
<a href=https://www.apache.org/licenses/>license</a>
and managed with
<a href=https://www.apache.org/foundation/how-it-works.html>
open governance</a> and
<a href=https://privacy.apache.org/policies/privacy-policy-public.html>
privacy policy</a>. See upcoming
<a href=https://www.apache.org/events/current-event>Apache Events</a>.
If you discover any
<a href=https://www.apache.org/security/>security</a> vulnerabilities, please
report them privately. Finally,
<a href=https://www.apache.org/foundation/sponsorship.html>thanks
</a> to the sponsors who
<a href=https://www.apache.org/foundation/contributing.html>
donate</a> to the Apache Foundation.
</p>
</div>
</div>
<div class="copyright row">
<a href=https://hive.apache.org style=color:grey>
The contents of this website are © 2023 Apache Software Foundation under the terms of the Apache License v2. Apache Hive and its logo are trademarks of the Apache Software Foundation.
</a>
</div>
</footer>
<script src=https://hive.apache.org/js/bootstrap.bundle.min.js></script>
</body>
</html>