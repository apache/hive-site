<!doctype html><html><!doctype html>
<html>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content>
<meta name=author content>
<title>Apache Hive : WebHCat InstallWebHCat</title>
<link rel=icon href=/images/hive.svg sizes=any type=image/svg+xml>
<link rel=stylesheet href=https://hive.apache.org/css/hive-theme.css>
<link rel=stylesheet href=https://hive.apache.org/css/font-awesome.all.min.css>
<link rel=stylesheet href=https://hive.apache.org/css/bootstrap.min.css>
<link rel=stylesheet href=https://hive.apache.org/css/termynal.css>
<link rel=apple-touch-icon sizes=180x180 href=https://hive.apache.org/images/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=https://hive.apache.org/images/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=https://hive.apache.org/images/favicon-16x16.png>
<link rel=manifest href=https://hive.apache.org/images/site.webmanifest>
<link rel=mask-icon href=https://hive.apache.org/images/safari-pinned-tab.svg color=#5bbad5>
<meta name=msapplication-TileColor content="#da532c">
<meta name=theme-color content="#ffffff">
<script>var _paq=window._paq=window._paq||[];_paq.push(['disableCookies']),_paq.push(['trackPageView']),_paq.push(['enableLinkTracking']),function(){var b="https://analytics.apache.org/",c,a,d;_paq.push(['setTrackerUrl',b+'matomo.php']),_paq.push(['setSiteId','30']),c=document,a=c.createElement('script'),d=c.getElementsByTagName('script')[0],a.async=!0,a.src=b+'matomo.js',d.parentNode.insertBefore(a,d)}()</script>
</head>
<body>
<body>
<header>
<menu style=background:#000;margin:0>
<nav class="navbar navbar-expand-lg navbar-dark bg-black">
<div class=container-fluid>
<a href=https://hive.apache.org> <img src=https://hive.apache.org/images/hive.svg width=60 height=35 alt="Apache Software Foundation"></a>
<a class="header-text navbar-brand" href=https://hive.apache.org>Apache Hive</a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span>
</button>
<div class="collapse navbar-collapse" id=navbarSupportedContent>
<ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item dropdown">
<a class=nav-link href=/general/downloads id=navbarDropdown role=button aria-expanded=false>
Releases
</a>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=/Document id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
Documentation
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=/docs/latest/>Latest</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/docs/javadocs/>Javadocs</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/LanguageManual>Language Manual</a></li>
</ul>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=/general id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
General
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=https://www.apache.org/licenses/LICENSE-2.0.html>License</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/general/privacypolicy/>Privacy Policy</a></li>
</ul>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
Development
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=https://hive.apache.org/development/gettingstarted/>Getting Started</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/development/quickstart/>Quickstart with Docker</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/DesignDocs>Design Docs</a></li>
<li><a class=dropdown-item href=https://issues.apache.org/jira/projects/HIVE/issues>Hive JIRA</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/HiveDeveloperFAQ>Hive Developer FAQ</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/Hive+PreCommit+Patch+Testing>Precommit Patch Testing</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/development/versioncontrol/>Version Control</a></li>
</ul>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
Community
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=/community/becomingcommitter/>Becoming A Committer</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/HowToContribute>How To Contribute</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/Home#Home-ResourcesforContributors>Resources for Contributors</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/community/mailinglists/>Mailing Lists</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/community/issuetracking/>Issue Tracking</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/community/people/>People</a></li>
<li>
<hr class=dropdown-divider>
</li>
<li><a class=dropdown-item href=/community/bylaws/>By Laws</a></li>
<li><a class=dropdown-item href=https://cwiki.apache.org/confluence/display/Hive/HowToRelease>How To Release</a></li>
</ul>
</li>
<li class="nav-item dropdown">
<a class=nav-link href=https://hive.blog.apache.org/ id=navbarDropdown role=button aria-expanded=false>
Blogs
</a>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
ASF
</a>
<ul class=dropdown-menu aria-labelledby=navbarDropdown>
<li><a class=dropdown-item href=https://www.apache.org/foundation/contributing.html>Donations</a></li>
<li><a class=dropdown-item href=https://www.apache.org/foundation/sponsorship.html>Sponsorship</a></li>
<li><a class=dropdown-item href=https://www.apache.org/foundation/thanks.html>Thanks</a></li>
<li><a class=dropdown-item href=https://www.apache.org/>Website</a></li>
</ul>
</li>
<li>
<form action=/search method=get class=search-bar>
<input type=search name=q id=search-query placeholder=Search... class=search-input>
<button type=submit class=search-button>Search</button>
</form>
</li>
</ul>
</div>
</div>
</nav>
</menu>
</header>
<div class=content>
<div class=docs>
<h1 id=apache-hive--webhcat-installwebhcat>Apache Hive : WebHCat InstallWebHCat</h1>
<h1 id=webhcat-installation>WebHCat Installation</h1>
<ul>
<li><a href=#webhcat-installation>WebHCat Installation</a>
<ul>
<li><a href=#webhcat-installed-with-hive>WebHCat Installed with Hive</a></li>
<li><a href=#webhcat-installation-procedure>WebHCat Installation Procedure</a></li>
<li><a href=#server-commands>Server Commands</a></li>
<li><a href=#requirements>Requirements</a></li>
<li><a href=#hadoop-distributed-cache>Hadoop Distributed Cache</a></li>
<li><a href=#permissions>Permissions</a></li>
<li><a href=#secure-cluster>Secure Cluster</a></li>
<li><a href=#proxy-user-support>Proxy User Support</a></li>
</ul>
</li>
</ul>
<h2 id=webhcat-installed-with-hive>WebHCat Installed with Hive</h2>
<p>Version</p>
<p>WebHCat and HCatalog are installed with Hive, starting with Hive release 0.11.0.</p>
<p>If you install Hive from the binary tarball, the WebHCat server command <code>webhcat_server.sh</code> is in the <code>hcatalog/sbin</code> directory.</p>
<p>Hive installation is documented <a href=https://hive.apache.org/docs/latest/adminmanual-installation_27362077/>here</a>.</p>
<h2 id=webhcat-installation-procedure>WebHCat Installation Procedure</h2>
<p><strong>Note:</strong> WebHCat was originally called Templeton. For backward compatibility the name still appears in URLs, log file names, variable names, etc.</p>
<ol>
<li>Ensure that the <a href=#required-related-installations>required related installations</a> are in place, and place required files into the <a href=#hadoop-distributed-cache>Hadoop distributed cache</a>.</li>
<li>Download and unpack the HCatalog distribution.</li>
<li>Set the <code>TEMPLETON_HOME</code> environment variable to the base of the HCatalog REST server installation. This will usually be same as <code>HCATALOG_HOME</code>. This is used to find the WebHCat (Templeton) configuration.</li>
<li>Set <code>JAVA_HOME</code>, <code>HADOOP_PREFIX</code>, and <code>HIVE_HOME</code> environment variables.</li>
<li>Review the <a href=https://hive.apache.org/docs/latest/webhcat-configure_34015738/>configuration</a> and update or create <code>webhcat-site.xml</code> as required. Ensure that site-specific component installation locations are accurate, especially the Hadoop configuration path. Configuration variables that use a filesystem path try to have reasonable defaults, but it&rsquo;s always safe to specify a full and complete path.</li>
<li>Verify that HCatalog is installed and that the <code>hcat</code> executable is in the <code>PATH</code>.</li>
<li>Build HCatalog using the command <code>ant jar</code> from the top level HCatalog directory.</li>
<li>Start the REST server with the command &ldquo;<code>hcatalog/sbin/webhcat_server.sh start</code>&rdquo; for Hive 0.11.0 releases and later, or &ldquo;<code>sbin/webhcat_server.sh start</code>&rdquo; for installations prior to HCatalog merging with Hive.</li>
<li>Check that your local install works. Assuming that the server is running on port 50111, the following command would give output similar to that shown.</li>
</ol>
<pre tabindex=0><code>% curl -i http://localhost:50111/templeton/v1/status
HTTP/1.1 200 OK
Content-Type: application/json
Transfer-Encoding: chunked
Server: Jetty(7.6.0.v20120127)

{&quot;status&quot;:&quot;ok&quot;,&quot;version&quot;:&quot;v1&quot;}
%

</code></pre><h2 id=server-commands>Server Commands</h2>
<ul>
<li><strong>Start the server:</strong> <code>sbin/webhcat_server.sh start</code> (HCatalog 0.5.0 and earlier – prior to Hive release 0.11.0)
<ul>
<li><code>hcatalog/sbin/webhcat_server.sh start</code> (Hive release 0.11.0 and later)</li>
</ul>
</li>
<li><strong>Stop the server:</strong> <code>sbin/webhcat_server.sh stop</code> (HCatalog 0.5.0 and earlier – prior to Hive release 0.11.0)
<ul>
<li><code>hcatalog/sbin/webhcat_server.sh stop</code> (Hive release 0.11.0 and later)</li>
</ul>
</li>
<li><strong>End-to-end build, run, test:</strong> <code>ant e2e</code></li>
</ul>
<h2 id=requirements>Requirements</h2>
<ul>
<li><a href=http://ant.apache.org/>Ant</a>, version 1.8 or higher</li>
<li><a href=http://hadoop.apache.org/>Hadoop</a>, version 1.0.3 or higher</li>
<li><a href=http://zookeeper.apache.org/>ZooKeeper</a> is required if you are using the ZooKeeper storage class. (Be sure to review and update the ZooKeeper-related <a href=#webhcat-configuration>WebHCat configuration</a>.)</li>
<li>HCatalog, version 0.5.0 or higher. The <code>hcat</code> executable must be both in the <code>PATH</code> and properly configured in the <a href=#webhcat-configuration>WebHCat configuration</a>.</li>
<li>Permissions must be given to the user running the server. (See below.)</li>
<li>If running a secure cluster, Kerberos keys and principals must be created. (See below.)</li>
<li><a href=#hadoop-distributed-cache>Hadoop Distributed Cache</a>. To use <a href=http://hive.apache.org/>Hive</a>, <a href=http://pig.apache.org/>Pig</a>, or <a href=http://hadoop.apache.org/docs/stable/streaming.html>Hadoop Streaming</a> resources, see instructions below for placing the required files in the Hadoop Distributed Cache.</li>
</ul>
<h2 id=hadoop-distributed-cache>Hadoop Distributed Cache</h2>
<p>The server requires some files be accessible on the <a href=http://hadoop.apache.org/docs/stable1/mapred_tutorial.html#DistributedCache>Hadoop distributed cache</a>. For example, to avoid the installation of Pig and Hive everywhere on the cluster, the server gathers a version of Pig or Hive from the Hadoop distributed cache whenever those resources are invoked. After placing the following components into HDFS please update the site configuration as required for each.</p>
<ul>
<li><strong>Hive:</strong> <a href=http://www.apache.org/dyn/closer.cgi/hive/>Download</a> the Hive tar.gz file and place it in HDFS. For example, for Hive version 0.11.0:</li>
</ul>
<pre tabindex=0><code>hadoop fs -put /tmp/hive-0.11.0.tar.gz /apps/templeton/hive-0.11.0.tar.gz

</code></pre><ul>
<li><strong>Pig:</strong> <a href=http://www.apache.org/dyn/closer.cgi/pig>Download</a> the Pig tar.gz file and place it into HDFS. For example, for Pig version 0.11.1:</li>
</ul>
<pre tabindex=0><code>hadoop fs -put /tmp/pig-0.11.1.tar.gz /apps/templeton/pig-0.11.1.tar.gz

</code></pre><ul>
<li><strong>Hadoop Streaming:</strong> Place <code>hadoop-streaming-*.jar</code> into HDFS. Use the following command:</li>
</ul>
<pre tabindex=0><code>hadoop fs -put &lt;hadoop streaming jar&gt; \
  &lt;templeton.streaming.jar&gt;/hadoop-streaming-*.jar

</code></pre><p>where <em>&lt;templeton.streaming.jar></em> is a property value defined in <code>webhcat-default.xml</code> which can be overridden in the <code>webhcat-site.xml</code> file, and <em></em> is the Hadoop streaming jar in your Hadoop version:</p>
<pre><code>+ `hadoop-1.*/contrib/streaming/hadoop-streaming-*.jar` in the Hadoop 1.x tar
+ `hadoop-2.*/share/hadoop/tools/lib/hadoop-streaming-*.jar` in the Hadoop 2.x tar  
 For example,



```
hadoop fs -put hadoop-2.1.0/share/hadoop/tools/lib/hadoop-streaming-2.1.0.jar \
  /apps/templeton/hadoop-streaming.jar

```
</code></pre>
<ul>
<li><strong>Override Jars:</strong> Place override jars required (if any) into HDFS. <em>Note:</em> Hadoop versions prior to 1.0.3 required a patch (<a href=https://issues.apache.org/jira/browse/HADOOP-7987>HADOOP-7987</a>) to properly run WebHCat. This patch is distributed with WebHCat (located at <code>templeton/src/hadoop_temp_fix/ugi.jar</code>) and should be placed into HDFS, as reflected in the current default configuration.</li>
</ul>
<pre tabindex=0><code>hadoop fs -put ugi.jar /apps/templeton/ugi.jar

</code></pre><p>The location of these files in the cache, and the location of the installations inside the archives, can be specified using the following WebHCat configuration variables. (See the <a href=https://hive.apache.org/docs/latest/webhcat-configure_34015738/>Configuration</a> documentation for more information on changing WebHCat configuration parameters.) Some default values vary depending on release number; defaults shown below are for the version of WebHCat that is included in Hive release 0.11.0. Defaults for the previous release are shown in the <a href=http://hive.apache.org/docs/hcat_r0.5.0/rest_server_install.html#Hadoop+Distributed+Cache>HCatalog 0.5.0 documentation</a>.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Default (Hive 0.11.0)</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>templeton.pig.archive</strong></td>
<td><code>hdfs:///apps/templeton/pig-0.11.1.tar.gz</code></td>
<td>The path to the Pig archive.</td>
</tr>
<tr>
<td><strong>templeton.pig.path</strong></td>
<td><code>pig-0.11.1.tar.gz/pig-0.11.1/bin/pig</code></td>
<td>The path to the Pig executable.</td>
</tr>
<tr>
<td><strong>templeton.hive.archive</strong></td>
<td><code>hdfs:///apps/templeton/hive-0.11.0.tar.gz</code></td>
<td>The path to the Hive archive.</td>
</tr>
<tr>
<td><strong>templeton.hive.path</strong></td>
<td><code>hive-0.11.0.tar.gz/hive-0.11.0/bin/hive</code></td>
<td>The path to the Hive executable.</td>
</tr>
<tr>
<td><strong>templeton.streaming.jar</strong></td>
<td><code>hdfs:///apps/templeton/hadoop-streaming.jar</code></td>
<td>The path to the Hadoop streaming jar file.</td>
</tr>
<tr>
<td><strong>templeton.override.jars</strong></td>
<td><code>hdfs:///apps/templeton/ugi.jar</code></td>
<td>Jars to add to the <code>HADOOP_CLASSPATH</code> for all Map Reduce jobs. These jars must exist on HDFS. This is not needed for Hadoop versions 1.0.1 and newer.</td>
</tr>
</tbody>
</table>
<h2 id=permissions>Permissions</h2>
<p>Permission must be given for the user running the WebHCat executable to run jobs for other users. That is, the WebHCat server will impersonate users on the Hadoop cluster.</p>
<p>Create (or assign) a Unix user who will run the WebHCat server. Call this USER. See the <a href=#secure-cluster>Secure Cluster</a> section below for choosing a user on a Kerberos cluster.</p>
<p>Modify the Hadoop core-site.xml file and set these properties:</p>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>hadoop.proxyuser.USER.groups</td>
<td>A comma-separated list of the Unix groups whose users will be impersonated.</td>
</tr>
<tr>
<td>hadoop.proxyuser.USER.hosts</td>
<td>A comma-separated list of the hosts that will run the HCatalog and JobTracker servers.</td>
</tr>
</tbody>
</table>
<h2 id=secure-cluster>Secure Cluster</h2>
<p>To run WebHCat on a secure cluster follow the <a href=#permissions>Permissions</a> instructions above but create a Kerberos principal for the WebHCat server with the name <code>USER/host@realm</code>.</p>
<p>Also, set the WebHCat configuration variables <code>templeton.kerberos.principal</code> and <code>templeton.kerberos.keytab</code>.</p>
<h2 id=proxy-user-support>Proxy User Support</h2>
<p>Proxy User Support in WebHCat allows the caller of WebHCat to instruct WebHCat to run commands on the Hadoop cluster as a particular user.</p>
<p>The canonical example is Joe using Hue to submit a MapReduce job through WebHCat. For the following description, assume Joe has the Unix name &lsquo;joe&rsquo;, Hue is &lsquo;hue&rsquo; and WebHCat is &lsquo;hcat&rsquo;. If Hue specifies &lsquo;doAs=joe&rsquo; when calling WebHCat, WebHCat submits the MR job as &lsquo;joe&rsquo; so that the Hadoop cluster can perform securitiy checks with respect to &lsquo;joe&rsquo;. If the doAs value is not specified, the MR job will be submitted as user &lsquo;hue&rsquo;.</p>
<p>To set up Proxy User Support, make the following edits in configuration files.</p>
<p>In hive-site.xml, set:</p>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>hive.security.metastore.authorization.manager</td>
<td>org.apache.hadoop.hive.ql.security.authorization.StorageBasedAuthorizationProvider</td>
</tr>
<tr>
<td>hive.security.metastore.authenticator.manager</td>
<td>org.apache.hadoop.hive.ql.security.HadoopDefaultMetastoreAuthenticator</td>
</tr>
<tr>
<td>hive.metastore.pre.event.listeners</td>
<td>org.apache.hadoop.hive.ql.security.authorization.AuthorizationPreEventListener</td>
</tr>
<tr>
<td>hive.metastore.execute.setugi</td>
<td>true</td>
</tr>
</tbody>
</table>
<p>In webhcat-site.xml, set:</p>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>webhcat.proxyuser.hue.groups</td>
<td>A comma-separated list of the Unix groups whose users may be impersonated by &lsquo;hue&rsquo;.</td>
</tr>
<tr>
<td>webhcat.proxyuser.hue.hosts</td>
<td>A comma-separated list of the hosts which are allowed to submit requests by &lsquo;hue&rsquo;. In the canonical example, this would be the servers running Hue.</td>
</tr>
</tbody>
</table>
<p>In core-site.xml, make sure the following are also set:</p>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>hadoop.proxyuser.hcat.group</td>
<td>A comma-separated list of the Unix groups whose users may be impersonated by &lsquo;hcat&rsquo;.</td>
</tr>
<tr>
<td>hadoop.proxyuser.hcat.hosts</td>
<td>A comma-separated list of the hosts which are allowed to submit requests by &lsquo;hcat&rsquo;.</td>
</tr>
</tbody>
</table>
<p><strong>Navigation Links</strong>
Previous: <a href=https://hive.apache.org/docs/latest/webhcat-usingwebhcat_34015492/>Using WebHCat</a><br>
Next: <a href=https://hive.apache.org/docs/latest/webhcat-configure_34015738/>Configuration</a></p>
<p>Hive installation: <a href=https://hive.apache.org/docs/latest/adminmanual-installation_27362077/>Installing Hive</a><br>
HCatalog installation: <a href=https://hive.apache.org/docs/latest/hcatalog-installhcat_34013403/>Installation from Tarball</a></p>
<p>General: <a href=https://hive.apache.org/docs/latest/webhcat_33299069/>WebHCat Manual</a> – <a href=https://hive.apache.org/docs/latest/hcatalog_33299065/>HCatalog Manual</a> – <a href=https://hive.apache.org/docs/latest/home_27362069/>Hive Wiki Home</a> – <a href=http://hive.apache.org/>Hive Project Site</a></p>
</div>
</div>
<footer class="black-background static-bottom" style=padding:30px>
<div class=row>
<div class=col-3>
<a href=https://www.apache.org/>
<img src=https://hive.apache.org/images/asf_logo.png width=270 height=100 alt="Apache Software Foundation"></a>
</a>
</div>
<div class=col-9>
<p class=footer-text>Apache is a non-profit organization helping open-source
software projects released under the Apache
<a href=https://www.apache.org/licenses/>license</a>
and managed with
<a href=https://www.apache.org/foundation/how-it-works.html>
open governance</a> and
<a href=https://privacy.apache.org/policies/privacy-policy-public.html>
privacy policy</a>. See upcoming
<a href=https://www.apache.org/events/current-event>Apache Events</a>.
If you discover any
<a href=https://www.apache.org/security/>security</a> vulnerabilities, please
report them privately. Finally,
<a href=https://www.apache.org/foundation/sponsorship.html>thanks
</a> to the sponsors who
<a href=https://www.apache.org/foundation/contributing.html>
donate</a> to the Apache Foundation.
</p>
</div>
</div>
<div class="copyright row">
<a href=https://hive.apache.org style=color:grey>
The contents of this website are © 2023 Apache Software Foundation under the terms of the Apache License v2. Apache Hive and its logo are trademarks of the Apache Software Foundation.
</a>
</div>
</footer>
<script src=https://hive.apache.org/js/bootstrap.bundle.min.js></script>
</body>
</html>