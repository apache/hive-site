<!doctype html><html><!doctype html>
<html>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content>
<meta name=author content>
<title>Apache Hive : AdminManual Metastore 3.0 Administration</title>
<link rel=icon href=/images/hive.svg sizes=any type=image/svg+xml>
<link rel=stylesheet href=https://hive.apache.org/css/hive-theme.css>
<link rel=stylesheet href=https://hive.apache.org/css/font-awesome.all.min.css>
<link rel=stylesheet href=https://hive.apache.org/css/bootstrap.min.css>
<link rel=stylesheet href=https://hive.apache.org/css/termynal.css>
<link rel=apple-touch-icon sizes=180x180 href=https://hive.apache.org/images/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=https://hive.apache.org/images/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=https://hive.apache.org/images/favicon-16x16.png>
<link rel=manifest href=https://hive.apache.org/images/site.webmanifest>
<link rel=mask-icon href=https://hive.apache.org/images/safari-pinned-tab.svg color=#5bbad5>
<meta name=msapplication-TileColor content="#da532c">
<meta name=theme-color content="#ffffff">
<script>var _paq=window._paq=window._paq||[];_paq.push(['disableCookies']),_paq.push(['trackPageView']),_paq.push(['enableLinkTracking']),function(){var b="https://analytics.apache.org/",c,a,d;_paq.push(['setTrackerUrl',b+'matomo.php']),_paq.push(['setSiteId','30']),c=document,a=c.createElement('script'),d=c.getElementsByTagName('script')[0],a.async=!0,a.src=b+'matomo.js',d.parentNode.insertBefore(a,d)}()</script>
</head>
<body>
<body>
<header>
<menu class=main-menu>
<nav class="navbar navbar-expand-lg navbar-dark">
<div class=container-fluid>
<div class=navbar-brand-wrapper>
<a href=https://hive.apache.org class=navbar-logo>
<img src=https://hive.apache.org/images/hive.svg width=50 height=30 alt="Apache Hive Logo">
</a>
<a class=navbar-brand href=https://hive.apache.org>Apache Hive</a>
</div>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span>
</button>
<div class="collapse navbar-collapse" id=navbarSupportedContent>
<ul class="navbar-nav me-auto">
<li class=nav-item>
<a class=nav-link href=https://hive.apache.org/general/downloads>
Releases
</a>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=/Document id=docsDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
Documentation
</a>
<ul class=dropdown-menu aria-labelledby=docsDropdown>
<li><a class=dropdown-item href=https://hive.apache.org/docs/latest/>Latest</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/docs/javadocs/>Javadocs</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/docs/latest/language/languagemanual>Language Manual</a></li>
</ul>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=/general id=generalDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
General
</a>
<ul class=dropdown-menu aria-labelledby=generalDropdown>
<li><a class=dropdown-item href=https://www.apache.org/licenses/LICENSE-2.0.html>License</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/general/privacypolicy/>Privacy Policy</a></li>
<li><a class=dropdown-item href=/general/poweredby/>Powered by</a></li>
</ul>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=# id=devDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
Development
</a>
<ul class=dropdown-menu aria-labelledby=devDropdown>
<li><a class=dropdown-item href=https://hive.apache.org/development/gettingstarted/>Getting Started</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/development/quickstart/>Quickstart with Docker</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/development/desingdocs/>Design Docs</a></li>
<li><a class=dropdown-item href=https://issues.apache.org/jira/projects/HIVE/issues>Hive JIRA</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/community/resources/hivedeveloperfaq>Hive Developer FAQ</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/development/versioncontrol/>Version Control</a></li>
</ul>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=# id=communityDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
Community
</a>
<ul class=dropdown-menu aria-labelledby=communityDropdown>
<li><a class=dropdown-item href=/community/becomingcommitter/>Becoming A Committer</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/community/resources/howtocontribute>How To Contribute</a></li>
<li><a class=dropdown-item href=/community/resources/>Resources</a></li>
<li><a class=dropdown-item href=/community/meetings/>Meetings</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/community/mailinglists/>Mailing Lists</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/community/issuetracking/>Issue Tracking</a></li>
<li><a class=dropdown-item href=https://hive.apache.org/community/people/>People</a></li>
<li><hr class=dropdown-divider></li>
<li><a class=dropdown-item href=/community/bylaws/>By Laws</a></li>
<li><a class=dropdown-item href=/community/resources/howtorelease/>How To Release</a></li>
</ul>
</li>
<li class=nav-item>
<a class=nav-link href=https://hive.blog.apache.org/>
Blogs
</a>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=# id=asfDropdown role=button data-bs-toggle=dropdown aria-expanded=false>
ASF
</a>
<ul class=dropdown-menu aria-labelledby=asfDropdown>
<li><a class=dropdown-item href=https://www.apache.org/foundation/contributing.html>Donations</a></li>
<li><a class=dropdown-item href=https://www.apache.org/foundation/sponsorship.html>Sponsorship</a></li>
<li><a class=dropdown-item href=https://www.apache.org/foundation/thanks.html>Thanks</a></li>
<li><a class=dropdown-item href=https://www.apache.org/>Website</a></li>
</ul>
</li>
</ul>
<div class=navbar-search>
<form action=/search method=get class=search-form>
<div class=search-input-group>
<input type=search name=q id=search-query placeholder=Search... class=search-input aria-label=Search>
<button type=submit class=search-button aria-label="Submit search">
<i class="fas fa-search"></i>
</button>
</div>
</form>
</div>
</div>
</div>
</nav>
</menu>
</header>
<div class=content>
<div class=docs-container>
<main class="docs-main docs-main-full">
<article class=docs-content>
<nav class=docs-breadcrumb>
<ol>
<li><a href=/><i class="fas fa-home"></i> Home</a></li>
<li><a href=/docs/>Documentation</a></li>
<li class=active>Apache Hive : AdminManual Metastore 3.0 Administration</li>
</ol>
</nav>
<header class=docs-header>
<h1 class=docs-title>Apache Hive : AdminManual Metastore 3.0 Administration</h1>
<div class=docs-meta>
<span class=docs-date>
<i class="fas fa-calendar-alt"></i>
Last updated: December 12, 2024
</span>
</div>
</header>
<div class=docs-toc>
<h4><i class="fas fa-list"></i> Table of Contents</h4>
<nav id=TableOfContents>
<ul>
<li><a href=#apache-hive--adminmanual-metastore-30-administration>Apache Hive : AdminManual Metastore 3.0 Administration</a>
<ul>
<li><a href=#version-note>Version Note</a></li>
<li><a href=#introduction>Introduction</a>
<ul>
<li><a href=#changes-from-hive-2-to-hive-3>Changes From Hive 2 to Hive 3</a></li>
</ul>
</li>
<li><a href=#general-configuration>General Configuration</a></li>
<li><a href=#rdbms>RDBMS</a>
<ul>
<li><a href=#option-1-embedding-derby>Option 1: Embedding Derby</a></li>
<li><a href=#option-2-external-rdbms>Option 2: External RDBMS</a></li>
<li><a href=#installing-and-upgrading-the-metastore-schema>Installing and Upgrading the Metastore Schema</a></li>
</ul>
</li>
<li><a href=#running-the-metastore>Running the Metastore</a>
<ul>
<li><a href=#embedded-mode>Embedded Mode</a></li>
<li><a href=#metastore-server>Metastore Server</a></li>
</ul>
</li>
<li><a href=#running-the-metastore-without-hive>Running the Metastore Without Hive</a></li>
<li><a href=#performance-optimizations>Performance Optimizations</a>
<ul>
<li><a href=#cachedstore>CachedStore</a></li>
</ul>
</li>
<li><a href=#less-commonly-changed-configuration-parameters>Less Commonly Changed Configuration Parameters</a></li>
</ul>
</li>
</ul>
</nav>
</div>
<div class=docs-article>
<h1 id=apache-hive--adminmanual-metastore-30-administration>Apache Hive : AdminManual Metastore 3.0 Administration</h1>
<aside class=table-of-contents>
<nav id=TableOfContents>
<ul>
<li><a href=#apache-hive--adminmanual-metastore-30-administration>Apache Hive : AdminManual Metastore 3.0 Administration</a>
<ul>
<li><a href=#version-note>Version Note</a></li>
<li><a href=#introduction>Introduction</a>
<ul>
<li><a href=#changes-from-hive-2-to-hive-3>Changes From Hive 2 to Hive 3</a></li>
</ul>
</li>
<li><a href=#general-configuration>General Configuration</a></li>
<li><a href=#rdbms>RDBMS</a>
<ul>
<li><a href=#option-1-embedding-derby>Option 1: Embedding Derby</a></li>
<li><a href=#option-2-external-rdbms>Option 2: External RDBMS</a></li>
<li><a href=#installing-and-upgrading-the-metastore-schema>Installing and Upgrading the Metastore Schema</a></li>
</ul>
</li>
<li><a href=#running-the-metastore>Running the Metastore</a>
<ul>
<li><a href=#embedded-mode>Embedded Mode</a></li>
<li><a href=#metastore-server>Metastore Server</a></li>
</ul>
</li>
<li><a href=#running-the-metastore-without-hive>Running the Metastore Without Hive</a></li>
<li><a href=#performance-optimizations>Performance Optimizations</a>
<ul>
<li><a href=#cachedstore>CachedStore</a></li>
</ul>
</li>
<li><a href=#less-commonly-changed-configuration-parameters>Less Commonly Changed Configuration Parameters</a></li>
</ul>
</li>
</ul>
</nav>
</aside>
<h2 id=version-note>Version Note</h2>
<p><strong>This document applies only to the Metastore in Hive 3.0 and later releases.</strong>  For Hive 0, 1, and 2 releases please see the <a href=https://hive.apache.org/docs/latest/admin/adminmanual-metastore-administration/>Metastore Administration</a> document.</p>
<h2 id=introduction>Introduction</h2>
<p>The definition of Hive objects such as databases, tables, and functions are stored in the Metastore.  Depending on how the system is configured, statistics and authorization records may also be stored there.  Hive, and other execution engines, use this data at runtime to determine how to parse, authorize, and efficiently execute user queries.  </p>
<p>The Metastore persists the object definitions to a relational database (RDBMS) via <a href=http://www.datanucleus.org/>DataNucleus</a>, a Java JDO based Object Relational Mapping (ORM) layer. See <a href=https://hive.apache.org/docs/latest/admin/adminmanual-metastore-3-0-administration/>Supported RDBMSs</a> below for a list of supported RDBMSs that can be used.</p>
<p>The Metastore can be configured to embed the Apache Derby RDBMS or connect to a external RDBMS.  The Metastore itself can be embedded entirely in a user process or run as a service for other processes to connect to.  Each of these options will be discussed in turn below.</p>
<h3 id=changes-from-hive-2-to-hive-3>Changes From Hive 2 to Hive 3</h3>
<p>Beginning in Hive 3.0, the Metastore can be run without the rest of Hive being installed.  It is provided as a separate release in order to allow non-Hive systems to easily integrate with it.  (It is, however, still included in the Hive release for convenience.)  Making the Metastore a standalone service involved changing a number of configuration parameter names and tool names.  All of the old configuration parameters and tools still work, in order to maximize backwards compatibility.  This document will cover both the old and new names.  As new functionality is added old, Hive style names will not be added.</p>
<p>For details on using the Metastore without Hive, see <a href=https://hive.apache.org/docs/latest/admin/adminmanual-metastore-3-0-administration/>Running the Metastore Without Hive</a> below.</p>
<h2 id=general-configuration>General Configuration</h2>
<p>The metastore reads its configuration from the file <code>metastore-site.xml</code>.  It expects to find this file in $<code>METASTORE_HOME/conf</code> where <code>$METASTORE_HOME</code> is an environment variable.  For backwards compatibility it will also read any <code>hive-site.xml</code> or <code>hive-metastoresite.xml</code>files found in <code>HIVE_HOME/conf</code>.  Configuration options can also be defined on the command line (see <a href=https://hive.apache.org/docs/latest/admin/adminmanual-metastore-3-0-administration/>Starting and Stopping the Service</a> below).</p>
<p>Configuration values specific to running the Metastore with various RDBMSs, embedded or as a service, and without Hive are discussed in the relevant sections.  The following configuration values apply to the Metastore regardless of how it is being run.  This table covers only commonly customized configuration values.  For less commonly changed configuration values see <a href=https://hive.apache.org/docs/latest/admin/adminmanual-metastore-3-0-administration/>Less Commonly Changed Configuration Parameters</a>.</p>
<p> </p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Hive 2 Parameter</th>
<th>Default Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>metastore.warehouse.dir</td>
<td>hive.metastore.warehouse.dir</td>
<td></td>
<td>URI of the default location for tables in the default catalog and database.</td>
</tr>
<tr>
<td>datanucleus.schema.autoCreateAll</td>
<td>datanucleus.schema.autoCreateAll</td>
<td>false</td>
<td>Auto creates the necessary schema in the RDBMS at startup if one does not exist. Set this to false after creating it once. To enable auto create also set hive.metastore.schema.verification=false. <strong>Auto creation is not recommended in production</strong>; run <code>schematool</code> instead.</td>
</tr>
<tr>
<td>metastore.schema.verification</td>
<td>hive.metastore.schema.verification</td>
<td>true</td>
<td>Enforce metastore schema version consistency. When set to true: verify that version information stored in the RDBMS is compatible with the version of the Metastore jar. Also disable automatic schema migration. Users are required to manually migrate the schema after upgrade, which ensures proper schema migration. This setting is strongly recommended in production.When set to false: warn if the version information stored in RDBMS doesn&rsquo;t match the version of the Metastore jar and allow auto schema migration.</td>
</tr>
<tr>
<td>metastore.hmshandler.retry.attempts</td>
<td>hive.hmshandler.retry.attempts</td>
<td>10</td>
<td>The number of times to retry a call to the meastore when there is a connection error.</td>
</tr>
<tr>
<td>metastore.hmshandler.retry.interval</td>
<td>hive.hmshandler.retry.interval</td>
<td>2 sec</td>
<td>Time between retry attempts.</td>
</tr>
<tr>
<td>metastore.log4j.file</td>
<td>hive.log4j.file</td>
<td>none</td>
<td>Log4j configuration file. If unset will look for <code>metastore-log4j2.properties</code> in $METASTORE_HOME/conf</td>
</tr>
<tr>
<td>metastore.stats.autogather</td>
<td>hive.stats.autogather</td>
<td>true</td>
<td>Whether to automatically gather basic statistics during insert commands.</td>
</tr>
</tbody>
</table>
<h2 id=rdbms>RDBMS</h2>
<h3 id=option-1-embedding-derby>Option 1: Embedding Derby</h3>
<p>The metastore can be run with <a href=https://db.apache.org/derby/>Apache Derby</a> embedded.  This is the default configuration.  However, it is not intended for use beyond simple testing.  In this configuration only one client can use the Metastore and any changes are not durable beyond the life of the client (since it uses an in memory version of Derby).</p>
<h3 id=option-2-external-rdbms>Option 2: External RDBMS</h3>
<p>For any durable, multi-user installation, an external RDBMS should be used to store Metastore objects.  The Metastore connects to an external RDBMS via JDBC.  Any jars required by the JDBC driver for your RDBMS should be placed in <code>METASTORE_HOME/lib</code> or explicilty passed on the command line.  The following values need to be configured to connect the Metastore to an RDBMS.  (Note:  these configuration parameters did not change between Hive 2 and 3.)</p>
<table>
<thead>
<tr>
<th>Configuration Parameter</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>javax.jdo.option.ConnectionURL</td>
<td>Connection URL for the JDBC driver</td>
</tr>
<tr>
<td>javax.jdo.option.ConnectionDriverName</td>
<td>JDBC driver class</td>
</tr>
<tr>
<td>javax.jdo.option.ConnectionUserName</td>
<td>User name to connect to the RDBMS with</td>
</tr>
<tr>
<td>javax.jdo.option.ConnectionPassword</td>
<td>Password to connect to the RDBMS with. The Metastore uses <a href=http://hadoop.apache.org/docs/r3.0.1/api/org/apache/hadoop/security/alias/CredentialProvider.html>Hadoop&rsquo;s CredentialProvider API</a> so this does not have to be stored in clear text in your configuration file.</td>
</tr>
</tbody>
</table>
<h4 id=supported-rdbmss>Supported RDBMSs</h4>
<p>As the Metastore uses DataNucleus to communicate with the RDBMS, theoretically any storage option supported by DataNucleus would work with the Metastore.  However, we only test and recommend the following:</p>
<table>
<thead>
<tr>
<th>RDBMS</th>
<th>Minimum Version</th>
<th>javax.jdo.option.ConnectionURL</th>
<th>javax.jdo.option.ConnectionDriverName</th>
</tr>
</thead>
<tbody>
<tr>
<td>MS SQL Server</td>
<td>2008 R2</td>
<td><code>jdbc:sqlserver://&lt;HOST>:&lt;PORT>;DatabaseName=&lt;SCHEMA></code></td>
<td><code>com.microsoft.sqlserver.jdbc.SQLServerDriver</code></td>
</tr>
<tr>
<td>MySQL</td>
<td>5.6.17</td>
<td><code>jdbc:mysql://&lt;HOST>:&lt;PORT>/&lt;SCHEMA></code></td>
<td><code>com.mysql.jdbc.Driver</code></td>
</tr>
<tr>
<td>MariaDB</td>
<td>5.5</td>
<td><code>jdbc:mysql://&lt;HOST>:&lt;PORT>/&lt;SCHEMA></code></td>
<td><code>org.mariadb.jdbc.Driver</code></td>
</tr>
<tr>
<td>Oracle*</td>
<td>11g</td>
<td><code>jdbc:oracle:thin:@//&lt;HOST>:&lt;PORT>/xe</code></td>
<td><code>oracle.jdbc.OracleDriver</code></td>
</tr>
<tr>
<td>Postgres</td>
<td>9.1.13</td>
<td><code>jdbc:postgresql://&lt;HOST>:&lt;PORT>/&lt;SCHEMA></code></td>
<td><code>org.postgresql.Driver</code></td>
</tr>
</tbody>
</table>
<p>&lt;HOST> = The host the RDBMS is on.</p>
<p>&lt;PORT> = Port the RDBMS is listening for JDBC connections on</p>
<p>&lt;SCHEMA> = The schema (or database) that the Metastore stores its tables in.</p>
<p>*The Oracle values shown are for Oracle&rsquo;s thin JDBC client.  If you are using a different client the ConnectionURL and ConnectionDriverName values will differ.</p>
<p><strong>Special Note:</strong>  When using Postgres you should set the configuration parameter <code>metastore.try.direct.sql.ddl</code> (previously <code>hive.metastore.try.direct.sql.ddl</code>) to false, to avoid failures in certain operations.</p>
<h3 id=installing-and-upgrading-the-metastore-schema>Installing and Upgrading the Metastore Schema</h3>
<p>The Metastore provides the <code>schematool</code> utility to work with the Metastore schema in the RDBMS.  For a full list of options see the <code>-help</code> option of the tool.  The following summarizes what the tool can do.  In most cases <code>schematool</code> can read the configuration from the <code>metastore-site.xml</code> file, though the configuration can also be passed as options on the command line.</p>
<ul>
<li><code>-initSchema</code>: install a new schema.  This should be used when first setting up a Metastore.</li>
<li><code>-upgradeSchema</code>: upgrade to the newly installed version.  For 3.0, upgrades can be done from 1.2, 2.0, 2.1, 2.2, and 2.3 to 3.0.  If you need to upgrade from before 1.2, use an older version of Hive&rsquo;s <code>schematool</code> to first upgrade your schema to 1.2, then use the current Metastore version to upgrade to 3.0.</li>
<li><code>-createUser</code>: create the Metastore user and schema.  This does not install the tables, it just creates the database user and schema.  This likely will not work in a production environment because you likely will not have permissions to create users and schemas.  You will likely need your DBA to do this for you.</li>
<li><code>-validate</code>: check that your Metastore schema is correct for its recorded version</li>
</ul>
<h2 id=running-the-metastore>Running the Metastore</h2>
<h3 id=embedded-mode>Embedded Mode</h3>
<p>The Metastore can be embedded directly into a process as a library.  This is often done with HiveServer2 to avoid an additional network hop for metadata operations.  It can also be done when using the Hive CLI or any other process.  This mode is the default and will be used anytime the configuration parameter <code>metastore.uris</code> is not set.</p>
<p>Except in the case of HiveServer2, using this mode raises a few concerns.  First, having many clients will put a burden on the backing RDBMS since each client will have its own set of connections.  Second, every client must have read/write access to the RDBMS.  This makes it hard to properly secure the RDBMS.  Therefore embedded mode is not recommended in production with the exception of HiveServer2.</p>
<h3 id=metastore-server>Metastore Server</h3>
<p>To run the Metastore as a service, you must first configure it with a URL.</p>
<table>
<thead>
<tr>
<th>Configured On</th>
<th>Parameter</th>
<th>Hive 2 Parameter</th>
<th>Format</th>
<th>Default Value</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>Client</td>
<td>metastore.thrift.uris</td>
<td>hive.metastore.uris</td>
<td>thrift://:[, thrift://:&mldr;]</td>
<td>none</td>
<td>HOST = hostname, PORT = should be set to match metastore.thrift.port on the server (which defaults to 9083. You can provide multiple servers in a comma separate list.</td>
</tr>
<tr>
<td>Server</td>
<td>metastore.thrift.port</td>
<td>hive.metastore.port</td>
<td>integer</td>
<td>9083</td>
<td>Port Thrift will listen on.</td>
</tr>
</tbody>
</table>
<p>Once you have configured your clients, you can start the Metastore on a server using the <code>start-metastore</code> utility.  See the <code>-help</code> option of that utility for available options.  There is no stop-metastore script.  You must locate the process id for the metastore and kill that process.</p>
<h4 id=high-availability>High Availability</h4>
<p>The Metastore service is stateless.  This allows you to start multiple instances of the service to provide for high availability.  It also allows you to configure some clients to embed the metastore (e.g. HiveServer2) while still running a Metastore service for other clients.  If you are running multiple Metastore services you can put all their URIs into your client&rsquo;s <code>metastore.thrift.uris</code> value and then set <code>metastore.thrift.uri.selection</code> ( in Hive 2 <code>hive.metastore.uri.selection</code>) to <code>RANDOM</code> or <code>SEQUENTIAL</code>.  <code>RANDOM</code> will cause your client to randomly select one of the servers in the list, while <code>SEQUENTIAL</code> will cause it to start at the beginning of the list and attempt to connect to each server in order.</p>
<h4 id=securing-the-service>Securing the Service</h4>
<p>TODO: Need to fill in details for setting up with Kerberos, SSL, etc.</p>
<p>CLIENT_KERBEROS_PRINCIPAL, KERBEROS_<em>, SSL</em>, USE_SSL, USE_THRIFT_SASL</p>
<h2 id=running-the-metastore-without-hive>Running the Metastore Without Hive</h2>
<p>Beginning in Hive 3.0, the Metastore is released as a separate package and can be run without the rest of Hive.  This is referred to as standalone mode. </p>
<p>By default the Metastore is configured for use with Hive, so a few configuration parameters have to be changed in this configuration.</p>
<table>
<thead>
<tr>
<th>Configuration Parameter</th>
<th>Set to for Standalone Mode</th>
</tr>
</thead>
<tbody>
<tr>
<td>metastore.task.threads.always</td>
<td>org.apache.hadoop.hive.metastore.events.EventCleanerTask,org.apache.hadoop.hive.metastore.MaterializationsCacheCleanerTask</td>
</tr>
<tr>
<td>metastore.expression.proxy</td>
<td>org.apache.hadoop.hive.metastore.DefaultPartitionExpressionProxy</td>
</tr>
</tbody>
</table>
<p>Currently the following features have not been tested or are known not to work with the Metastore in standalone mode:</p>
<ul>
<li>The compactor (for use with ACID tables) cannot be run without Hive.  ACID tables can be read and written to, but they cannot compacted.</li>
<li>Replication has not been tested outside of Hive.</li>
</ul>
<h2 id=performance-optimizations>Performance Optimizations</h2>
<h3 id=cachedstore>CachedStore</h3>
<p>Prior to Hive 3.0 there was only a single implementation of the MetaStore API (called <code>ObjectStore</code>). <a href=https://issues.apache.org/jira/browse/HIVE-16520>HIVE-16520</a> introduced a second implementation that can cache objects from the database in memory. This can save a significant amount of time for round trips to the database. It can be used by changing the parameter <code>metastore.rawstore.impl</code> to <code>org.apache.hadoop.hive.metastore.cache.CachedStore</code>.</p>
<p>The cache is automatically updated with new data when changes are made through this MetaStore. In a scenario where there are multiple MetaStore servers the caches can be out of date on some of them. To prevent this the CachedStore automatically refreshes the cache in a configurable frequency (default: 1 minute).</p>
<p>Details about all properties for the CachedStore can be found on <a href=https://hive.apache.org/docs/latest/user/configuration-properties/>Configuration Properties</a> (Prefix: <code>metastore.cached</code>). </p>
<h2 id=less-commonly-changed-configuration-parameters>Less Commonly Changed Configuration Parameters</h2>
<p>BATCHED_RETRIEVE_<em>, CLIENT_CONNECT_RETRY_DELAY, FILTER_HOOK, SERDES_USING_METASTORE_FOR_SCHEMA, SERVER_</em>_THREADS, </p>
<pre tabindex=0><code>THREAD_POOL_SIZE
</code></pre><p>Security: EXECUTE_SET_UGI, metastore.authorization.storage.checks</p>
<p>Setting up Caching: CACHED*, CATALOGS_TO_CACHE & AGGREGATE_STATS_CACHE*</p>
<p>Transactions: MAX_OPEN_TXNS, TXNS_*</p>
<p> </p>
<p> </p>
</div>
<footer class=docs-footer>
<div class=docs-feedback>
<h4><i class="fas fa-comment"></i> Feedback</h4>
<p>Was this page helpful? Let us know how we can improve.</p>
<div class=docs-feedback-buttons>
<button class="btn btn-feedback btn-positive">
<i class="fas fa-thumbs-up"></i> Yes
</button>
<button class="btn btn-feedback btn-negative">
<i class="fas fa-thumbs-down"></i> No
</button>
</div>
</div>
<div class=docs-edit>
<a href=https://github.com/apache/hive-site/edit/main/content/docs/latest/admin/adminmanual-metastore-3-0-administration.md class="btn btn-outline">
<i class="fab fa-github"></i> Edit this page on GitHub
</a>
</div>
</footer>
</article>
<aside class=docs-toc-sidebar>
<div class=docs-toc-sticky>
<h4><i class="fas fa-list"></i> On this page</h4>
<nav id=TableOfContents>
<ul>
<li><a href=#apache-hive--adminmanual-metastore-30-administration>Apache Hive : AdminManual Metastore 3.0 Administration</a>
<ul>
<li><a href=#version-note>Version Note</a></li>
<li><a href=#introduction>Introduction</a>
<ul>
<li><a href=#changes-from-hive-2-to-hive-3>Changes From Hive 2 to Hive 3</a></li>
</ul>
</li>
<li><a href=#general-configuration>General Configuration</a></li>
<li><a href=#rdbms>RDBMS</a>
<ul>
<li><a href=#option-1-embedding-derby>Option 1: Embedding Derby</a></li>
<li><a href=#option-2-external-rdbms>Option 2: External RDBMS</a></li>
<li><a href=#installing-and-upgrading-the-metastore-schema>Installing and Upgrading the Metastore Schema</a></li>
</ul>
</li>
<li><a href=#running-the-metastore>Running the Metastore</a>
<ul>
<li><a href=#embedded-mode>Embedded Mode</a></li>
<li><a href=#metastore-server>Metastore Server</a></li>
</ul>
</li>
<li><a href=#running-the-metastore-without-hive>Running the Metastore Without Hive</a></li>
<li><a href=#performance-optimizations>Performance Optimizations</a>
<ul>
<li><a href=#cachedstore>CachedStore</a></li>
</ul>
</li>
<li><a href=#less-commonly-changed-configuration-parameters>Less Commonly Changed Configuration Parameters</a></li>
</ul>
</li>
</ul>
</nav>
</div>
</aside>
</main>
</div>
</div>
<footer class="black-background static-bottom" style=padding:30px>
<div class=row>
<div class=col-3>
<a href=https://www.apache.org/>
<img src=https://hive.apache.org/images/asf_logo.png width=270 height=100 alt="Apache Software Foundation"></a>
</a>
</div>
<div class=col-9>
<p class=footer-text>Apache is a non-profit organization helping open-source
software projects released under the Apache
<a href=https://www.apache.org/licenses/>license</a>
and managed with
<a href=https://www.apache.org/foundation/how-it-works.html>
open governance</a> and
<a href=https://privacy.apache.org/policies/privacy-policy-public.html>
privacy policy</a>. See upcoming
<a href=https://www.apache.org/events/current-event>Apache Events</a>.
If you discover any
<a href=https://www.apache.org/security/>security</a> vulnerabilities, please
report them privately. Finally,
<a href=https://www.apache.org/foundation/sponsorship.html>thanks
</a> to the sponsors who
<a href=https://www.apache.org/foundation/contributing.html>
donate</a> to the Apache Foundation.
</p>
</div>
</div>
<div class="copyright row">
<a href=https://hive.apache.org style=color:grey>
The contents of this website are © 2023 Apache Software Foundation under the terms of the Apache License v2. Apache Hive and its logo are trademarks of the Apache Software Foundation.
</a>
</div>
</footer>
<script src=https://hive.apache.org/js/bootstrap.bundle.min.js></script>
</body>
</html>